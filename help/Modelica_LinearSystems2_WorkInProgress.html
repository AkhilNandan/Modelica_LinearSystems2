<HTML>
<HEAD>
<TITLE>Modelica_LinearSystems2.WorkInProgress</TITLE>
<META name="HTML-Generator" content="Dymola">
<META name="description" content="&quot;Package for developments and internal models&quot;">
<style type="text/css">
*       { font-size: 10pt; font-family: Arial,sans-serif; }
pre     { font-size:  9pt; font-family: Courier,monospace;}
h4      { font-size: 10pt; font-weight: bold; color: green; }
h3      { font-size: 11pt; font-weight: bold; color: green; }
h2      { font-size: 13pt; font-weight: bold; color: green; }
address {                  font-weight: normal} 
td      { solid #000; vertical-align:top; }
th      { solid #000; vertical-align:top; font-weight: bold; }
table   { solid #000; border-collapse: collapse;}
</style>
</HEAD>
<BODY><P>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE WorkInProgress<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="Modelica_LinearSystems2.WorkInProgress"></A><A HREF="Modelica_LinearSystems2.html#Modelica_LinearSystems2"
>Modelica_LinearSystems2</A>.WorkInProgress</H2>
<B>Package for developments and internal models</B>
<P>
<P><H3>Package Content</H3><p>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2 >
<TR><TH >Name</TH><TH>Description</TH></TR>
<TR><TD><IMG SRC="Modelica_LinearSystems2.WorkInProgress.DiscreteStateSpaceS.png" ALT="Modelica_LinearSystems2.WorkInProgress.DiscreteStateSpace" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_LinearSystems2_WorkInProgress.html#Modelica_LinearSystems2.WorkInProgress.DiscreteStateSpace"
>DiscreteStateSpace</A>
</TD><TD>Discrete state space description of a linear, time invariant difference equation system (data + operations)</TD></TR>
<TR><TD><IMG SRC="Modelica_LinearSystems2.WorkInProgress.ControllerS.png" ALT="Modelica_LinearSystems2.WorkInProgress.Controller" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_LinearSystems2_WorkInProgress_Controller.html#Modelica_LinearSystems2.WorkInProgress.Controller"
>Controller</A>
</TD><TD>&nbsp;</TD></TR>
<TR><TD><IMG SRC="Modelica_LinearSystems2.WorkInProgress.ControllerS.png" ALT="Modelica_LinearSystems2.WorkInProgress.Icons" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_LinearSystems2_WorkInProgress_Icons.html#Modelica_LinearSystems2.WorkInProgress.Icons"
>Icons</A>
</TD><TD>Icons used in the Linear Systems library</TD></TR>
<TR><TD><IMG SRC="Modelica_LinearSystems2.WorkInProgress.ControllerS.png" ALT="Modelica_LinearSystems2.WorkInProgress.Optimizer" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_LinearSystems2_WorkInProgress_Optimizer.html#Modelica_LinearSystems2.WorkInProgress.Optimizer"
>Optimizer</A>
</TD><TD>&nbsp;</TD></TR>
<TR><TD><IMG SRC="Modelica_LinearSystems2.WorkInProgress.ControllerS.png" ALT="Modelica_LinearSystems2.WorkInProgress.StateSpace" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_LinearSystems2_WorkInProgress_StateSpace.html#Modelica_LinearSystems2.WorkInProgress.StateSpace"
>StateSpace</A>
</TD><TD>State space functions</TD></TR>
<TR><TD><IMG SRC="Modelica_LinearSystems2.WorkInProgress.ControllerS.png" ALT="Modelica_LinearSystems2.WorkInProgress.TransferFunction" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_LinearSystems2_WorkInProgress_TransferFunction.html#Modelica_LinearSystems2.WorkInProgress.TransferFunction"
>TransferFunction</A>
</TD><TD>&nbsp;</TD></TR>
<TR><TD><IMG SRC="Modelica_LinearSystems2.WorkInProgress.ControllerS.png" ALT="Modelica_LinearSystems2.WorkInProgress.ZerosAndPoles" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_LinearSystems2_WorkInProgress_ZerosAndPoles.html#Modelica_LinearSystems2.WorkInProgress.ZerosAndPoles"
>ZerosAndPoles</A>
</TD><TD>&nbsp;</TD></TR>
<TR><TD><IMG SRC="Modelica_LinearSystems2.WorkInProgress.ControllerS.png" ALT="Modelica_LinearSystems2.WorkInProgress.Tests" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_LinearSystems2_WorkInProgress_Tests.html#Modelica_LinearSystems2.WorkInProgress.Tests"
>Tests</A>
</TD><TD>Functions to test the LinearSystems functions </TD></TR>
<TR><TD><IMG SRC="Modelica_LinearSystems2.WorkInProgress.ControllerS.png" ALT="Modelica_LinearSystems2.WorkInProgress.Math" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_LinearSystems2_WorkInProgress_Math.html#Modelica_LinearSystems2.WorkInProgress.Math"
>Math</A>
</TD><TD>&nbsp;</TD></TR>
<TR><TD><IMG SRC="Modelica_LinearSystems2.WorkInProgress.ControllerS.png" ALT="Modelica_LinearSystems2.WorkInProgress.MPC" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_LinearSystems2_WorkInProgress_MPC.html#Modelica_LinearSystems2.WorkInProgress.MPC"
>MPC</A>
</TD><TD>Model Predictive Control</TD></TR>
<TR><TD><IMG SRC="Modelica_LinearSystems2.WorkInProgress.ControllerS.png" ALT="Modelica_LinearSystems2.WorkInProgress.Junk" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_LinearSystems2_WorkInProgress_Junk.html#Modelica_LinearSystems2.WorkInProgress.Junk"
>Junk</A>
</TD><TD>rubbish</TD></TR>
<TR><TD><IMG SRC="Modelica_LinearSystems2.WorkInProgress.StateSpace2S.png" ALT="Modelica_LinearSystems2.WorkInProgress.StateSpace2" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_LinearSystems2_WorkInProgress.html#Modelica_LinearSystems2.WorkInProgress.StateSpace2"
>StateSpace2</A>
</TD><TD>Continuous state space description of a linear, time invariant differential equation system (data + operations)</TD></TR>
</TABLE>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE DiscreteStateSpace<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Modelica_LinearSystems2.WorkInProgress.DiscreteStateSpaceI.png" ALT="Modelica_LinearSystems2.WorkInProgress.DiscreteStateSpace" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Modelica_LinearSystems2.WorkInProgress.DiscreteStateSpace"></A><A HREF="Modelica_LinearSystems2_WorkInProgress.html#Modelica_LinearSystems2.WorkInProgress"
>Modelica_LinearSystems2.WorkInProgress</A>.DiscreteStateSpace</H2>
<B>Discrete state space description of a linear, time invariant difference equation system (data + operations)</B><p>
<P><H3>Information</H3></P>
<PRE></pre>
<p>
This record defines a linear time invariant difference
equation system in state space form:
</p>
<pre>     <b>x</b>(Ts*(k+1)) = <b>A</b> * <b>x</b>(Ts*k) + <b>B</b> * <b>u</b>(Ts*k)
     <b>y</b>(Ts*k)     = <b>C</b> * <b>x</b>(Ts*k) + <b>D</b> * <b>u</b>(Ts*k)
     <b>x</b>_continuous(Ts*k) = <b>x</b>(Ts*k) + <b>B2</b> * <b>u</b>(Ts*k) 
</pre>
<p>
with
</p>
<ul>
<li> <b>Ts</b> - the sample time</li>
<li> <b>k</b> - the index of the actual sample instance (k=0,1,2,3,...)</li>
<li> <b>t</b> - the time</li>
<li> <b>u</b>(t) - the input vector,</li>
<li> <b>y</b>(t) - the output vector,</li>
<li> <b>x</b>(t) - the discrete state vector (x(t=Ts*0) is the initial state),</li>
<li> <b>x</b>_continuous(t) - the state vector of the continuous system
     from which the discrete block has been derived (details see below),</li>
<li> <b>A,B,C,D,B2</b> - matrices of appropriate dimensions.</li>
</ul>
<p>
A discrete system is usually derived by discretization from a 
continuous block, e.g., by function
LinearSystems.DiscreteStateSpace.fromStateSpace.
If the discretization method, e.g., the trapezoidal method,
accesses <b>actual and past</b> values of the input <b>u</b> 
(e.g. <b>u</b>(Ts*k), <b>u</b>(Ts*(k-1), <b>u</b>(Ts*(k-2))), 
a state transformation is needed to get the difference equation 
above where only the actual value <b>u</b>(Ts*k) is accessed. 
</p>
<p>
If the original continuous state vector should be computed
from the sampled data system above, the matrices of this 
transformation have to be known. For simplicity and efficiency,
here only the specific transformation used by function
LinearSystems.DiscreteStateSpace.fromStateSpace is stored in 
the data record of the discrete system via matrix <b>B2</b>.
Therefore, the state vector of the underlying continuous
system can be calculated by adding the term <b>B2</b>*<b>u</b> to the
state vector of the discretized system.
</p>
<p>
In Modelica notation, the difference equation above
can be implemented as:
</p>
<pre>
     <b>when</b> {<b>initial</b>(), <b>sample</b>(Ts,Ts)} <b>then</b>
        new_x = A * x + B * u;
            y = C * x + D * u;
            x = <b>pre</b>(new_x);
        x_continuous = x + B2 * u;
     <b>end when</b>;
</pre>
<p>
Since no "next value" operator is available in Modelica, an
auxiliary variable new_x stores the value of x for the
next sampling instant. The relationship between new_x and x
is defined via equation "x = <b>pre</b>(new_x)".
</p>
<p>
The body of the when-clause is active during initialization and at the
next sample instant t=Ts. Note, the when-equation is not
active after the initialization at t=0 (due to <b>sample</b>(Ts,Ts)), 
since the state x of the initialization has to be used also at t=0.
</p>
<p>
In library Blocks.<b>Controller</b> additional equations are
added for the initialization to uniquely compute the
initial vector x:
</p>
<pre>
  <b>initial equation</b> 
     <b>if</b> init == InitialState <b>then</b>
        x = x_start;
     <b>elseif</b> init == SteadyState <b>then</b>
        x = new_x;
     <b>end if</b>;
</pre>
<p>
Optionally, x is set to a given start vector x_start.
As <b>default initialization</b>, the equation "x = new_x" is
added that defines steady state initialization for the
discrete system. As a consequence, the output y(Ts*k), k=0,1,2,..,
remains constant after this initialization, 
provided the input vector u(Ts*k) remains constant.
</p>
<pre></PRE><P>
Extends from Modelica.Icons.Record (Icon for records).
<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Description</TH></TR>
<TR bgcolor="#e0e0e0"><TD colspan=2>new_x = A*x + B*u;  y = C*x + D*u;  x_cont = x + B2*u</TD></TR>
<TR><TD>A[:, size(A, 1)]</TD><TD>&nbsp;</TD></TR>
<TR><TD>B[size(A, 1), :]</TD><TD>&nbsp;</TD></TR>
<TR><TD>C[:, size(A, 1)]</TD><TD>&nbsp;</TD></TR>
<TR><TD>D[size(C, 1), size(B, 2)]</TD><TD>&nbsp;</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=2>Data used to construct discrete from continuous system</TD></TR>
<TR><TD>Ts</TD><TD>Sample time [s]</TD></TR>
<TR><TD>B2[size(B, 1), size(B, 2)]</TD><TD>Reconstruct continuous state</TD></TR>
<TR><TD>method</TD><TD>Discretization method</TD></TR>
</TABLE>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE StateSpace2<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Modelica_LinearSystems2.WorkInProgress.DiscreteStateSpaceI.png" ALT="Modelica_LinearSystems2.WorkInProgress.StateSpace2" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Modelica_LinearSystems2.WorkInProgress.StateSpace2"></A><A HREF="Modelica_LinearSystems2_WorkInProgress.html#Modelica_LinearSystems2.WorkInProgress"
>Modelica_LinearSystems2.WorkInProgress</A>.StateSpace2</H2>
<B>Continuous state space description of a linear, time invariant differential equation system (data + operations)</B><p>
<P><H3>Information</H3></P>
<PRE></pre>
<p>
This record defines a linear time invariant differential
equation system in state space form:
</p>
<pre>    <b>der</b>(x) = A * x + B * u
        y  = C * x + D * u
</pre>
<p>
with
</p>
<ul>
<li> u - the input vector</li>
<li> y - the output vector</li>
<li> x - the state vector</li>
<li> A,B,C,D - matrices of appropriate dimensions</li>
</ul>
<pre></PRE><P>
Extends from Modelica.Icons.Record (Icon for records).
<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Description</TH></TR>
<TR bgcolor="#e0e0e0"><TD colspan=2>der(x) = A*x + B*u;  y = C*x + D*u</TD></TR>
<TR><TD>A[:, size(A, 1)]</TD><TD>&nbsp;</TD></TR>
<TR><TD>B[size(A, 1), :]</TD><TD>&nbsp;</TD></TR>
<TR><TD>C[:, size(A, 1)]</TD><TD>&nbsp;</TD></TR>
<TR><TD>D[size(C, 1), size(B, 2)]</TD><TD>&nbsp;</TD></TR>
</TABLE>
<address>HTML-documentation generated by <a href="http://www.Dymola.com/">Dymola</a> Wed Oct 27 10:53:50 2010.
</address></BODY>
</HTML>
