<HTML>
<HEAD>
<TITLE>Modelica_LinearSystems2.WorkInProgress.Tests.care</TITLE>
<META name="HTML-Generator" content="Dymola">
<META name="description" content="&quot;Test functions for continuous algebraic Riccato equations&quot;">
<style type="text/css">
*       { font-size: 10pt; font-family: Arial,sans-serif; }
pre     { font-size:  9pt; font-family: Courier,monospace;}
h4      { font-size: 10pt; font-weight: bold; color: green; }
h3      { font-size: 11pt; font-weight: bold; color: green; }
h2      { font-size: 13pt; font-weight: bold; color: green; }
address {                  font-weight: normal} 
td      { solid #000; vertical-align:top; }
th      { solid #000; vertical-align:top; font-weight: bold; }
table   { solid #000; border-collapse: collapse;}
</style>
</HEAD>
<BODY><P>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE care<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="Modelica_LinearSystems2.WorkInProgress.Tests.care"></A><A HREF="Modelica_LinearSystems2_WorkInProgress_Tests.html#Modelica_LinearSystems2.WorkInProgress.Tests"
>Modelica_LinearSystems2.WorkInProgress.Tests</A>.care</H2>
<B>Test functions for continuous algebraic Riccato equations</B>
<P>
<P><H3>Package Content</H3><p>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2 >
<TR><TH >Name</TH><TH>Description</TH></TR>
<TR><TD><IMG SRC="Modelica_LinearSystems2.WorkInProgress.Tests.care.care1S.png" ALT="Modelica_LinearSystems2.WorkInProgress.Tests.care.care1" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_LinearSystems2_WorkInProgress_Tests_care.html#Modelica_LinearSystems2.WorkInProgress.Tests.care.care1"
>care1</A>
</TD><TD>Example 1 from Benner benchmarks</TD></TR>
<TR><TD><IMG SRC="Modelica_LinearSystems2.WorkInProgress.Tests.care.care1S.png" ALT="Modelica_LinearSystems2.WorkInProgress.Tests.care.care2" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_LinearSystems2_WorkInProgress_Tests_care.html#Modelica_LinearSystems2.WorkInProgress.Tests.care.care2"
>care2</A>
</TD><TD>Example 2 from Benner benchmarks</TD></TR>
<TR><TD><IMG SRC="Modelica_LinearSystems2.WorkInProgress.Tests.care.care1S.png" ALT="Modelica_LinearSystems2.WorkInProgress.Tests.care.care3" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_LinearSystems2_WorkInProgress_Tests_care.html#Modelica_LinearSystems2.WorkInProgress.Tests.care.care3"
>care3</A>
</TD><TD>Example 3 from Benner benchmarks</TD></TR>
<TR><TD><IMG SRC="Modelica_LinearSystems2.WorkInProgress.Tests.care.care1S.png" ALT="Modelica_LinearSystems2.WorkInProgress.Tests.care.care4" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_LinearSystems2_WorkInProgress_Tests_care.html#Modelica_LinearSystems2.WorkInProgress.Tests.care.care4"
>care4</A>
</TD><TD>Example 4 from Benner benchmarks</TD></TR>
<TR><TD><IMG SRC="Modelica_LinearSystems2.WorkInProgress.Tests.care.care1S.png" ALT="Modelica_LinearSystems2.WorkInProgress.Tests.care.care5" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_LinearSystems2_WorkInProgress_Tests_care.html#Modelica_LinearSystems2.WorkInProgress.Tests.care.care5"
>care5</A>
</TD><TD>Example 5 from Benner benchmarks</TD></TR>
<TR><TD><IMG SRC="Modelica_LinearSystems2.WorkInProgress.Tests.care.care1S.png" ALT="Modelica_LinearSystems2.WorkInProgress.Tests.care.care6" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_LinearSystems2_WorkInProgress_Tests_care.html#Modelica_LinearSystems2.WorkInProgress.Tests.care.care6"
>care6</A>
</TD><TD>Example 6 from Benner benchmarks</TD></TR>
<TR><TD><IMG SRC="Modelica_LinearSystems2.WorkInProgress.Tests.care.care1S.png" ALT="Modelica_LinearSystems2.WorkInProgress.Tests.care.care7" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_LinearSystems2_WorkInProgress_Tests_care.html#Modelica_LinearSystems2.WorkInProgress.Tests.care.care7"
>care7</A>
</TD><TD>Example 7  from Benner benchmarks</TD></TR>
<TR><TD><IMG SRC="Modelica_LinearSystems2.WorkInProgress.Tests.care.care1S.png" ALT="Modelica_LinearSystems2.WorkInProgress.Tests.care.care8" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_LinearSystems2_WorkInProgress_Tests_care.html#Modelica_LinearSystems2.WorkInProgress.Tests.care.care8"
>care8</A>
</TD><TD>Example 8  from Benner benchmarks</TD></TR>
<TR><TD><IMG SRC="Modelica_LinearSystems2.WorkInProgress.Tests.care.care1S.png" ALT="Modelica_LinearSystems2.WorkInProgress.Tests.care.care9" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_LinearSystems2_WorkInProgress_Tests_care.html#Modelica_LinearSystems2.WorkInProgress.Tests.care.care9"
>care9</A>
</TD><TD>Example 9  from Benner benchmarks</TD></TR>
<TR><TD><IMG SRC="Modelica_LinearSystems2.WorkInProgress.Tests.care.care1S.png" ALT="Modelica_LinearSystems2.WorkInProgress.Tests.care.care10" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_LinearSystems2_WorkInProgress_Tests_care.html#Modelica_LinearSystems2.WorkInProgress.Tests.care.care10"
>care10</A>
</TD><TD>Example 10  from Benner benchmarks</TD></TR>
<TR><TD><IMG SRC="Modelica_LinearSystems2.WorkInProgress.Tests.care.care1S.png" ALT="Modelica_LinearSystems2.WorkInProgress.Tests.care.care11" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_LinearSystems2_WorkInProgress_Tests_care.html#Modelica_LinearSystems2.WorkInProgress.Tests.care.care11"
>care11</A>
</TD><TD>Example 11  from Benner benchmarks</TD></TR>
<TR><TD><IMG SRC="Modelica_LinearSystems2.WorkInProgress.Tests.care.care1S.png" ALT="Modelica_LinearSystems2.WorkInProgress.Tests.care.care12" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_LinearSystems2_WorkInProgress_Tests_care.html#Modelica_LinearSystems2.WorkInProgress.Tests.care.care12"
>care12</A>
</TD><TD>Example 12  from Benner benchmarks</TD></TR>
<TR><TD><IMG SRC="Modelica_LinearSystems2.WorkInProgress.Tests.care.care1S.png" ALT="Modelica_LinearSystems2.WorkInProgress.Tests.care.care13" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_LinearSystems2_WorkInProgress_Tests_care.html#Modelica_LinearSystems2.WorkInProgress.Tests.care.care13"
>care13</A>
</TD><TD>Example 13  from Benner benchmarks</TD></TR>
<TR><TD><IMG SRC="Modelica_LinearSystems2.WorkInProgress.Tests.care.care1S.png" ALT="Modelica_LinearSystems2.WorkInProgress.Tests.care.care14" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_LinearSystems2_WorkInProgress_Tests_care.html#Modelica_LinearSystems2.WorkInProgress.Tests.care.care14"
>care14</A>
</TD><TD>Example 14  from Benner benchmarks</TD></TR>
<TR><TD><IMG SRC="Modelica_LinearSystems2.WorkInProgress.Tests.care.care1S.png" ALT="Modelica_LinearSystems2.WorkInProgress.Tests.care.care15" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_LinearSystems2_WorkInProgress_Tests_care.html#Modelica_LinearSystems2.WorkInProgress.Tests.care.care15"
>care15</A>
</TD><TD>Example 15  from Benner benchmarks</TD></TR>
<TR><TD><IMG SRC="Modelica_LinearSystems2.WorkInProgress.Tests.care.care1S.png" ALT="Modelica_LinearSystems2.WorkInProgress.Tests.care.runAll" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_LinearSystems2_WorkInProgress_Tests_care.html#Modelica_LinearSystems2.WorkInProgress.Tests.care.runAll"
>runAll</A>
</TD><TD>Executes all functions with name care*.mo in this directory/package</TD></TR>
</TABLE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE care1<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Modelica_LinearSystems2.WorkInProgress.Tests.care.care1I.png" ALT="Modelica_LinearSystems2.WorkInProgress.Tests.care.care1" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Modelica_LinearSystems2.WorkInProgress.Tests.care.care1"></A><A HREF="Modelica_LinearSystems2_WorkInProgress_Tests_care.html#Modelica_LinearSystems2.WorkInProgress.Tests.care"
>Modelica_LinearSystems2.WorkInProgress.Tests.care</A>.care1</H2>
<B>Example 1 from Benner benchmarks</B><p>
<P><H3>Information</H3></P>
Extends from <A HREF="file:///C:/Programme/Dymola 7.4 Alpha/Modelica/Library/Modelica 3.1/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A> (Icon for a function).
<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>String</TD><TD>outputFile</TD><TD>&quot;&quot;</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>X1[2, 2]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>X2[2, 2]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>X3[2, 2]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku1</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku2</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku3</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> care1 <font color="darkgreen">&quot;Example 1 from Benner benchmarks&quot;</font>
  <font color="blue">extends </font><A HREF="file:///C:/Programme/Dymola 7.4 Alpha/Modelica/Library/Modelica 3.1/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A>;
  <font color="blue">import </font><A HREF="Modelica_LinearSystems2_Math_Matrices.html#Modelica_LinearSystems2.Math.Matrices"
>Modelica_LinearSystems2.Math.Matrices</A>;
  <font color="blue">input </font>String outputFile = &quot;&quot;;

<font color="blue">protected </font>
  Real A[2,2]=[0.0,1.0; 0.0,0.0];
  Real B[2,1]=[0.0; 1.0];
  Real R[1,1]=[1];
  Real Q[2,2]=[1.0,0.0; 0.0,2.0];
  Real G[2,2]=[0,0; 0,1] <font color="darkgreen">&quot;B*inv(R)*transpose(B)&quot;</font>;
  Real H[4,4]=[A,-G; -Q,-<font color="red">transpose</font>(A)];
  Real condH=<font color="red">Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(
                                               H);
  Real normH=<font color="red">Matrices.norm</font>(H, 2);
  Real condX1;
  Real normX1;
  Real condX2;
  Real normX2;
  Real condX3;
  Real normX3;
  Real Qr1[2,2];
  Real Qr2[2,2];
  Real Qr3[2,2];
  Real deltaQ1;
  Real deltaQ2;
  Real deltaQ3;
  Real resX1;
  Real resX2;
<font color="blue">public </font>
  <font color="blue">output </font>Real X1[2,2]=<font color="red">Matrices.care</font>(A, B, R, Q, false);
  <font color="blue">output </font>Real X2[2,2]=<font color="red">Matrices.care</font>(A, B, R, Q, true);
  <font color="blue">output </font>Real X3[2,2]=[2.0,1.0; 1.0,2.0];
  <font color="blue">output </font>Real ku1=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X1);
  <font color="blue">output </font>Real ku2=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X2);
  <font color="blue">output </font>Real ku3=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X3);

<font color="blue">algorithm </font>
  Qr1 := X1*G*X1-<font color="red">transpose</font>(A)*X1-X1*A;
  Qr2 := X2*G*X2-<font color="red">transpose</font>(A)*X2-X2*A;
  Qr3 := X3*G*X3-<font color="red">transpose</font>(A)*X3-X3*A;
  deltaQ1 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr1)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  deltaQ2 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr2)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  deltaQ3 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr3)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);

  resX1 :=<font color="red"> Modelica.Math.Matrices.norm</font>(X1-X3)/<font color="red">Modelica.Math.Matrices.norm</font>(X3);
  resX2 :=<font color="red"> Modelica.Math.Matrices.norm</font>(X2-X3)/<font color="red">Modelica.Math.Matrices.norm</font>(X3);

  condX1 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X1);
  normX1 :=<font color="red"> Matrices.norm</font>(X1, 2);
  condX2 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X2);
  normX2 :=<font color="red"> Matrices.norm</font>(X2, 2);
  condX3 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X3);
  normX3 :=<font color="red"> Matrices.norm</font>(X3, 2);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Solution X1 without subsequent Newton refinement&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X1, 16, &quot;X1&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Solution X2 with subsequent Newton refinement&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X2, 16, &quot;X2&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Exact solution X3&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X3, 16, &quot;X3&quot;),outputFile);

  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Residum of solution X1: resX1 = &quot;+<font color="red">String</font>(resX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Residum of solution X2: resX2 = &quot;+<font color="red">String</font>(resX2),outputFile);

  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normH = &quot; +<font color="red"> String</font>(normH),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condH = &quot; +<font color="red"> String</font>(condH),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX1 = &quot; +<font color="red"> String</font>(normX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX1 = &quot; +<font color="red"> String</font>(condX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku1 = &quot; +<font color="red"> String</font>(ku1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX2 = &quot; +<font color="red"> String</font>(normX2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX2 = &quot; +<font color="red"> String</font>(condX2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku2 = &quot; +<font color="red"> String</font>(ku2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX3 = &quot; +<font color="red"> String</font>(normX3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX3 = &quot; +<font color="red"> String</font>(condX3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku3 = &quot; +<font color="red"> String</font>(ku3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ1 = &quot; +<font color="red"> String</font>(deltaQ1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ2 = &quot; +<font color="red"> String</font>(deltaQ2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ3 = &quot; +<font color="red"> String</font>(deltaQ3),outputFile);

<font color="blue">end </font>care1;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE care2<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Modelica_LinearSystems2.WorkInProgress.Tests.care.care1I.png" ALT="Modelica_LinearSystems2.WorkInProgress.Tests.care.care2" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Modelica_LinearSystems2.WorkInProgress.Tests.care.care2"></A><A HREF="Modelica_LinearSystems2_WorkInProgress_Tests_care.html#Modelica_LinearSystems2.WorkInProgress.Tests.care"
>Modelica_LinearSystems2.WorkInProgress.Tests.care</A>.care2</H2>
<B>Example 2 from Benner benchmarks</B><p>
<P><H3>Information</H3></P>
Extends from <A HREF="file:///C:/Programme/Dymola 7.4 Alpha/Modelica/Library/Modelica 3.1/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A> (Icon for a function).
<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>String</TD><TD>outputFile</TD><TD>&quot;&quot;</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>X1[2, 2]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>X2[2, 2]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>X3[2, 2]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku1</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku2</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku3</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> care2 <font color="darkgreen">&quot;Example 2 from Benner benchmarks&quot;</font>
  <font color="blue">extends </font><A HREF="file:///C:/Programme/Dymola 7.4 Alpha/Modelica/Library/Modelica 3.1/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A>;
  <font color="blue">import </font><A HREF="Modelica_LinearSystems2_Math_Matrices.html#Modelica_LinearSystems2.Math.Matrices"
>Modelica_LinearSystems2.Math.Matrices</A>;
  <font color="blue">input </font>String outputFile = &quot;&quot;;
<font color="blue">protected </font>
  Real A[2,2]=[4,3; -9/2,-7/2];
  Real B[2,1]=[1; -1];
  Real R[1,1]=[1];
  Real Q[2,2]=[9,6; 6,4];
  Real G[2,2]=[1, -1; -1, 1] <font color="darkgreen">&quot;B*inv(R)*transpose(B)&quot;</font>;
  Real H[4,4]=[A,-G; -Q,-<font color="red">transpose</font>(A)];
  Real condH=<font color="red">Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(
                                               H);
  Real normH=<font color="red">Matrices.norm</font>(H, 2);
  Real condX1;
  Real normX1;
  Real condX2;
  Real normX2;
  Real condX3;
  Real normX3;
  Real Qr1[2,2];
  Real Qr2[2,2];
  Real Qr3[2,2];
  Real deltaQ1;
  Real deltaQ2;
  Real deltaQ3;
  Real resX1;
  Real resX2;
<font color="blue">public </font>
  <font color="blue">output </font>Real X1[2,2]=<font color="red">Matrices.care</font>(A, B, R, Q, false);
  <font color="blue">output </font>Real X2[2,2]=<font color="red">Matrices.care</font>(A, B, R, Q, true);
  <font color="blue">output </font>Real X3[2,2]=[9*(1 +<font color="red"> sqrt</font>(2)),6*(1 +<font color="red"> sqrt</font>(2)); 6*(1 +<font color="red"> sqrt</font>(2)),4*(1 +
      <font color="red">sqrt</font>(2))];
  <font color="blue">output </font>Real ku1=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X1);
  <font color="blue">output </font>Real ku2=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X2);
  <font color="blue">output </font>Real ku3=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X3);

<font color="blue">algorithm </font>
  Qr1 := X1*G*X1-<font color="red">transpose</font>(A)*X1-X1*A;
  Qr2 := X2*G*X2-<font color="red">transpose</font>(A)*X2-X2*A;
  Qr3 := X3*G*X3-<font color="red">transpose</font>(A)*X3-X3*A;
  deltaQ1 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr1)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  deltaQ2 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr2)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  deltaQ3 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr3)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  resX1 :=<font color="red"> Modelica.Math.Matrices.norm</font>(X1-X3)/<font color="red">Modelica.Math.Matrices.norm</font>(X3);
  resX2 :=<font color="red"> Modelica.Math.Matrices.norm</font>(X2-X3)/<font color="red">Modelica.Math.Matrices.norm</font>(X3);

  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Solution X1 without subsequent Newton refinement&quot;);
  <font color="red">Matrices.printMatrix</font>(X1, 16, &quot;X1&quot;);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Solution X2 with subsequent Newton refinement&quot;);
  <font color="red">Matrices.printMatrix</font>(X2, 16, &quot;X2&quot;);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Exact solution X3&quot;);
  <font color="red">Matrices.printMatrix</font>(X3, 16, &quot;X3&quot;);

  condX1 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(
                                              X1);
  normX1 :=<font color="red"> Matrices.norm</font>(X1, 2);
  condX2 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(
                                              X2);
  normX2 :=<font color="red"> Matrices.norm</font>(X2, 2);
  condX3 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(
                                           X3);
  normX3 :=<font color="red"> Matrices.norm</font>(X3, 2);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Solution X1 without subsequent Newton refinement&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X1, 16, &quot;X1&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Solution X2 with subsequent Newton refinement&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X2, 16, &quot;X2&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Exact solution X3&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X3, 16, &quot;X3&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Residum of solution X1: resX1 = &quot;+<font color="red">String</font>(resX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Residum of solution X2: resX2 = &quot;+<font color="red">String</font>(resX2),outputFile);

  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normH = &quot; +<font color="red"> String</font>(normH),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condH = &quot; +<font color="red"> String</font>(condH),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX1 = &quot; +<font color="red"> String</font>(normX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX1 = &quot; +<font color="red"> String</font>(condX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku1 = &quot; +<font color="red"> String</font>(ku1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX2 = &quot; +<font color="red"> String</font>(normX2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX2 = &quot; +<font color="red"> String</font>(condX2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku2 = &quot; +<font color="red"> String</font>(ku2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX3 = &quot; +<font color="red"> String</font>(normX3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX3 = &quot; +<font color="red"> String</font>(condX3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku3 = &quot; +<font color="red"> String</font>(ku3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ1 = &quot; +<font color="red"> String</font>(deltaQ1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ2 = &quot; +<font color="red"> String</font>(deltaQ2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ3 = &quot; +<font color="red"> String</font>(deltaQ3),outputFile);

<font color="blue">end </font>care2;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE care3<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Modelica_LinearSystems2.WorkInProgress.Tests.care.care1I.png" ALT="Modelica_LinearSystems2.WorkInProgress.Tests.care.care3" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Modelica_LinearSystems2.WorkInProgress.Tests.care.care3"></A><A HREF="Modelica_LinearSystems2_WorkInProgress_Tests_care.html#Modelica_LinearSystems2.WorkInProgress.Tests.care"
>Modelica_LinearSystems2.WorkInProgress.Tests.care</A>.care3</H2>
<B>Example 3 from Benner benchmarks</B><p>
<P><H3>Information</H3></P>
Extends from <A HREF="file:///C:/Programme/Dymola 7.4 Alpha/Modelica/Library/Modelica 3.1/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A> (Icon for a function).
<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>String</TD><TD>outputFile</TD><TD>&quot;&quot;</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>X1[4, 4]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>X2[4, 4]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>X3[4, 4]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku1</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku2</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku3</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> care3 <font color="darkgreen">&quot;Example 3 from Benner benchmarks&quot;</font>
  <font color="blue">extends </font><A HREF="file:///C:/Programme/Dymola 7.4 Alpha/Modelica/Library/Modelica 3.1/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A>;
  <font color="blue">import </font><A HREF="Modelica_LinearSystems2_Math_Matrices.html#Modelica_LinearSystems2.Math.Matrices"
>Modelica_LinearSystems2.Math.Matrices</A>;

  <font color="blue">input </font>String outputFile = &quot;&quot;;

<font color="blue">protected </font>
  Real A[4,4]=[0.0,   1.0,   0.0,   0.0;
               0.0,  -1.890,   3.900e-01,  -5.530;
               0.0,  -3.400e-02,  -2.980,   2.430;
               3.400e-02,  -1.100e-03,  -9.900e-01,  -2.100e-01];
  Real B[4,2]=[ 0.0,   0.0;
                3.600e-01,  -1.60;
               -9.500e-01,  -3.200e-02;
                3.000e-02,   0.0];
  Real R[2,2]=[1, 0; 0, 1];
  Real Q[4,4]=[2.313,   2.727,   6.880e-01,   2.300e-02;
               2.727,   4.271,  1.148,   3.230e-01;
               6.880e-01,   1.148,   3.130e-01,   1.020e-01;
               2.300e-02,   3.230e-01,   1.020e-01,   8.300e-02];
  Real G[4,4]=B*<font color="red">transpose</font>(B);
  Real H[8,8]=[A,-G; -Q,-<font color="red">transpose</font>(A)];
  Real condH=<font color="red">Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(
                                               H);
  Real normH=<font color="red">Matrices.norm</font>(H, 2);
  Real condX1;
  Real normX1;
  Real condX2;
  Real normX2;
  Real condX3;
  Real normX3;
  Real Qr1[4,4];
  Real Qr2[4,4];
  Real Qr3[4,4];
  Real deltaQ1;
  Real deltaQ2;
  Real deltaQ3;
  Real resX1;
  Real resX2;
<font color="blue">public </font>
  <font color="blue">output </font>Real X1[4,4]=<font color="red">Matrices.care</font>(A, B, R, Q, false);
  <font color="blue">output </font>Real X2[4,4]=<font color="red">Matrices.care</font>(A, B, R, Q, true);
  <font color="blue">output </font>Real X3[4,4]=[
  1.3238595718183990,               9.0153284952164081e-001,   5.4663403916715425e-001,  -1.7672385587639674;
  9.0153284952164081e-001,   9.6068122262991273e-001,   4.3342816873410484e-001,  -1.1989126854651069;
  5.4663403916715425e-001,   4.3342816873410484e-001,   4.6054882548934967e-001,  -1.3632873589876660;
 -1.7672385587639674,              -1.1989126854651069,     -1.3632873589876660,              4.4611816254580852];

  <font color="blue">output </font>Real ku1=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X1);
  <font color="blue">output </font>Real ku2=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X2);
  <font color="blue">output </font>Real ku3=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X3);

<font color="blue">algorithm </font>
  Qr1 := X1*G*X1-<font color="red">transpose</font>(A)*X1-X1*A;
  Qr2 := X2*G*X2-<font color="red">transpose</font>(A)*X2-X2*A;
  Qr3 := X3*G*X3-<font color="red">transpose</font>(A)*X3-X3*A;
  deltaQ1 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr1)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  deltaQ2 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr2)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  deltaQ3 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr3)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  resX1 :=<font color="red"> Modelica.Math.Matrices.norm</font>(X1-X3)/<font color="red">Modelica.Math.Matrices.norm</font>(X3);
  resX2 :=<font color="red"> Modelica.Math.Matrices.norm</font>(X2-X3)/<font color="red">Modelica.Math.Matrices.norm</font>(X3);

  condX1 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X1);
  normX1 :=<font color="red"> Matrices.norm</font>(X1, 2);
  condX2 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X2);
  normX2 :=<font color="red"> Matrices.norm</font>(X2, 2);
  condX3 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X3);
  normX3 :=<font color="red"> Matrices.norm</font>(X3, 2);

  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Solution X1 without subsequent Newton refinement&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X1, 16, &quot;X1&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Solution X2 with subsequent Newton refinement&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X2, 16, &quot;X2&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;MATLAB solution X3&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X3, 16, &quot;X3&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Residum of solution X1: resX1 = &quot;+<font color="red">String</font>(resX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Residum of solution X2: resX2 = &quot;+<font color="red">String</font>(resX2),outputFile);

  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normH = &quot; +<font color="red"> String</font>(normH),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condH = &quot; +<font color="red"> String</font>(condH),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX1 = &quot; +<font color="red"> String</font>(normX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX1 = &quot; +<font color="red"> String</font>(condX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku1 = &quot; +<font color="red"> String</font>(ku1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX2 = &quot; +<font color="red"> String</font>(normX2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX2 = &quot; +<font color="red"> String</font>(condX2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku2 = &quot; +<font color="red"> String</font>(ku2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX3 = &quot; +<font color="red"> String</font>(normX3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX3 = &quot; +<font color="red"> String</font>(condX3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku3 = &quot; +<font color="red"> String</font>(ku3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ1 = &quot; +<font color="red"> String</font>(deltaQ1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ2 = &quot; +<font color="red"> String</font>(deltaQ2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ3 = &quot; +<font color="red"> String</font>(deltaQ3),outputFile);

<font color="darkgreen">//   Modelica.Utilities.Streams.print(&quot;Solution X1 without subsequent Newton refinement&quot;);</font>
<font color="darkgreen">//   Modelica.Utilities.Streams.print(Matrices.printMatrix(X1, 16, &quot;X1&quot;));</font>
<font color="darkgreen">//   Modelica.Utilities.Streams.print(&quot;Solution X2 with subsequent Newton refinement&quot;);</font>
<font color="darkgreen">//   Modelica.Utilities.Streams.print(Matrices.printMatrix(X2, 16, &quot;X2&quot;));</font>
<font color="darkgreen">//   Modelica.Utilities.Streams.print(&quot;MATLAB solution X3&quot;);</font>
<font color="darkgreen">//   Modelica.Utilities.Streams.print(Matrices.printMatrix(X3, 16, &quot;X3&quot;));</font>
<font color="darkgreen">//   Modelica.Utilities.Streams.print(&quot;\n normH = &quot; + String(normH));</font>
<font color="darkgreen">//   Modelica.Utilities.Streams.print(&quot;\n condH = &quot; + String(condH));</font>
<font color="darkgreen">//   Modelica.Utilities.Streams.print(&quot;\n normX1 = &quot; + String(normX1));</font>
<font color="darkgreen">//   Modelica.Utilities.Streams.print(&quot;\n condX1 = &quot; + String(condX1));</font>
<font color="darkgreen">//   Modelica.Utilities.Streams.print(&quot;\n ku1 = &quot; + String(ku1));</font>
<font color="darkgreen">//   Modelica.Utilities.Streams.print(&quot;\n normX2 = &quot; + String(normX2));</font>
<font color="darkgreen">//   Modelica.Utilities.Streams.print(&quot;\n condX2 = &quot; + String(condX2));</font>
<font color="darkgreen">//   Modelica.Utilities.Streams.print(&quot;\n ku2 = &quot; + String(ku2));</font>
<font color="darkgreen">//   Modelica.Utilities.Streams.print(&quot;\n normX3 = &quot; + String(normX3));</font>
<font color="darkgreen">//   Modelica.Utilities.Streams.print(&quot;\n condX3 = &quot; + String(condX3));</font>
<font color="darkgreen">//   Modelica.Utilities.Streams.print(&quot;\n ku3 = &quot; + String(ku3));</font>
<font color="darkgreen">//   Modelica.Utilities.Streams.print(&quot;\n deltaQ1 = &quot; + String(deltaQ1));</font>
<font color="darkgreen">//   Modelica.Utilities.Streams.print(&quot;\n deltaQ2 = &quot; + String(deltaQ2));</font>
<font color="darkgreen">//   Modelica.Utilities.Streams.print(&quot;\n deltaQ3 = &quot; + String(deltaQ3));</font>

<font color="blue">end </font>care3;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE care4<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Modelica_LinearSystems2.WorkInProgress.Tests.care.care1I.png" ALT="Modelica_LinearSystems2.WorkInProgress.Tests.care.care4" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Modelica_LinearSystems2.WorkInProgress.Tests.care.care4"></A><A HREF="Modelica_LinearSystems2_WorkInProgress_Tests_care.html#Modelica_LinearSystems2.WorkInProgress.Tests.care"
>Modelica_LinearSystems2.WorkInProgress.Tests.care</A>.care4</H2>
<B>Example 4 from Benner benchmarks</B><p>
<P><H3>Information</H3></P>
Extends from <A HREF="file:///C:/Programme/Dymola 7.4 Alpha/Modelica/Library/Modelica 3.1/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A> (Icon for a function).
<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>String</TD><TD>outputFile</TD><TD>&quot;&quot;</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>X1[8, 8]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>X2[8, 8]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>X3[8, 8]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku1</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku2</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku3</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> care4 <font color="darkgreen">&quot;Example 4 from Benner benchmarks&quot;</font>
  <font color="blue">extends </font><A HREF="file:///C:/Programme/Dymola 7.4 Alpha/Modelica/Library/Modelica 3.1/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A>;
  <font color="blue">import </font><A HREF="Modelica_LinearSystems2_Math_Matrices.html#Modelica_LinearSystems2.Math.Matrices"
>Modelica_LinearSystems2.Math.Matrices</A>;

  <font color="blue">input </font>String outputFile = &quot;&quot;;

<font color="blue">protected </font>
  Real A[8,8]=[  -9.910e-01,   5.290e-01,   0.0,   0.0,   0.0,  0.0,   0.0,   0.0;
                  5.220e-01,  -1.051,   5.960e-01,   0.0,   0.0, 0.0,   0.0,   0.0;
                  0.0,   5.220e-01,  -1.118,   5.960e-01,   0.0,  0.0,   0.0,   0.0;
                  0.0,   0.0,   5.220e-01,  -1.548,   7.180e-01,  0.0,   0.0,   0.0;
                  0.0,   0.0,   0.0,   9.220e-01,  -1.640, 7.990e-01,   0.0,   0.0;
                  0.0,   0.0,   0.0,   0.0,   9.220e-01, -1.721,   9.010e-01,   0.0;
                  0.0,   0.0,   0.0,   0.0,   0.0, 9.220e-01,  -1.823,   1.021;
                  0.0,   0.0,   0.0,   0.0,   0.0, 0.0,   9.220e-01,  -1.943];

  Real B[8,2]=1e-3*[3.840,  -2.880;
                    4.0,  -3.040;
                   37.60,  -2.800;
                   3.080,  -2.320;
                   2.360,  -3.320;
                   2.880,  -3.820;
                   3.080,  -4.120;
                   3.0,  -3.960];

  Real R[2,2]=[1, 0; 0, 1];
  Real Q[8,8]=[  1.0,   0.0,   0.0,   0.0,   5.0e-01, 0.0,   0.0,   1.0e-01;
                 0.0,   1.0,   0.0,   0.0,   1.0e-01, 0.0,   0.0,   0.0;
                 0.0,   0.0,   1.0,   0.0,   0.0, 5.0e-01,   0.0,   0.0;
                 0.0,   0.0,   0.0,   1.0,   0.0, 0.0,   0.0,   0.0;
                 5.0e-01,   1.0e-01,   0.0,   0.0,   1.0e-01, 0.0,   0.0,   0.0;
                 0.0,   0.0,   5.0e-01,   0.0,   0.0, 1.0e-01,   0.0,   0.0;
                 0.0,   0.0,   0.0,   0.0,   0.0, 0.0,   1.0e-01,   0.0;
                 1.0e-01,   0.0,   0.0,   0.0,   0.0, 0.0,   0.0,   1.0e-01];
  Real G[8,8]=B*<font color="red">transpose</font>(B);
  Real H[16,16]=[A,-G; -Q,-<font color="red">transpose</font>(A)];
  Real condH=<font color="red">Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(
                                               H);
  Real normH=<font color="red">Matrices.norm</font>(H, 2);
  Real condX1;
  Real normX1;
  Real condX2;
  Real normX2;
  Real condX3;
  Real normX3;
  Real Qr1[8,8];
  Real Qr2[8,8];
  Real Qr3[8,8];
  Real deltaQ1;
  Real deltaQ2;
  Real deltaQ3;
<font color="blue">public </font>
  <font color="blue">output </font>Real X1[8,8]=<font color="red">Matrices.care</font>(A, B, R, Q, false);
  <font color="blue">output </font>Real X2[8,8]=<font color="red">Matrices.care</font>(A, B, R, Q, true);

  <font color="blue">output </font>Real X3[8,8]=[8.9189179333315727e-001,   7.3663786199205217e-001,   6.0233803898550886e-001,   5.2119369438941698e-001,   5.9291413705093765e-001,   3.4884170426731775e-001,   2.1987251788724343e-001,   1.4147828732718845e-001;
                       7.3663786199205217e-001,   1.3795283147296966e+000,   1.0764852472252566e+000,   8.0385954540875648e-001,   7.0054708500170060e-001,   5.1907694010695571e-001,   3.3482970113161148e-001,   1.7436126307010602e-001;
                       6.0233803898550886e-001,   1.0764852472252566e+000,   1.4919719225454409e+000,   1.0138055847275820e+000,   8.0136227954219730e-001,   7.4348008693508494e-001,   4.1924715019049130e-001,   2.0305623101755202e-001;
                       5.2119369438941698e-001,   8.0385954540875648e-001,   1.0138055847275820e+000,   1.1487703436604533e+000,   7.3268221838065584e-001,   5.3128128249432527e-001,   3.4101748640719931e-001,   1.7321992448577761e-001;
                       5.9291413705093765e-001,   7.0054708500170060e-001,   8.0136227954219730e-001,   7.3268221838065584e-001,   5.9205254501700877e-001,   4.2933248637928978e-001,   2.8472012561858129e-001,   1.4763528881298796e-001;
                       3.4884170426731775e-001,   5.1907694010695571e-001,   7.4348008693508494e-001,   5.3128128249432527e-001,   4.2933248637928978e-001,   3.5530939867621736e-001,   2.3769595202736848e-001,   1.2407312100669236e-001;
                       2.1987251788724343e-001,   3.3482970113161148e-001,   4.1924715019049130e-001,   3.4101748640719931e-001,   2.8472012561858129e-001,   2.3769595202736848e-001,   1.9654065110986793e-001,   1.0236228817160951e-001;
                       1.4147828732718845e-001,   1.7436126307010602e-001,   2.0305623101755202e-001,   1.7321992448577761e-001,   1.4763528881298796e-001,   1.2407312100669236e-001,   1.0236228817160951e-001,   7.9489693942802808e-002];
  <font color="blue">output </font>Real ku1=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X1);
  <font color="blue">output </font>Real ku2=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X2);
  <font color="blue">output </font>Real ku3=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X3);

<font color="blue">algorithm </font>
  Qr1 := X1*G*X1-<font color="red">transpose</font>(A)*X1-X1*A;
  Qr2 := X2*G*X2-<font color="red">transpose</font>(A)*X2-X2*A;
  Qr3 := X3*G*X3-<font color="red">transpose</font>(A)*X3-X3*A;
  deltaQ1 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr1)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  deltaQ2 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr2)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  deltaQ3 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr3)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);

  condX1 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X1);
  normX1 :=<font color="red"> Matrices.norm</font>(X1, 2);
  condX2 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X2);
  normX2 :=<font color="red"> Matrices.norm</font>(X2, 2);
  condX3 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X3);
  normX3 :=<font color="red"> Matrices.norm</font>(X3, 2);

  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Solution X1 without subsequent Newton refinement&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X1, 16, &quot;X1&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Solution X2 with subsequent Newton refinement&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X2, 16, &quot;X2&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;MATLAB solution X3&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X3, 16, &quot;X3&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normH = &quot; +<font color="red"> String</font>(normH),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condH = &quot; +<font color="red"> String</font>(condH),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX1 = &quot; +<font color="red"> String</font>(normX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX1 = &quot; +<font color="red"> String</font>(condX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku1 = &quot; +<font color="red"> String</font>(ku1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX2 = &quot; +<font color="red"> String</font>(normX2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX2 = &quot; +<font color="red"> String</font>(condX2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku2 = &quot; +<font color="red"> String</font>(ku2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX3 = &quot; +<font color="red"> String</font>(normX3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX3 = &quot; +<font color="red"> String</font>(condX3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku3 = &quot; +<font color="red"> String</font>(ku3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ1 = &quot; +<font color="red"> String</font>(deltaQ1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ2 = &quot; +<font color="red"> String</font>(deltaQ2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ3 = &quot; +<font color="red"> String</font>(deltaQ3),outputFile);

<font color="blue">end </font>care4;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE care5<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Modelica_LinearSystems2.WorkInProgress.Tests.care.care1I.png" ALT="Modelica_LinearSystems2.WorkInProgress.Tests.care.care5" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Modelica_LinearSystems2.WorkInProgress.Tests.care.care5"></A><A HREF="Modelica_LinearSystems2_WorkInProgress_Tests_care.html#Modelica_LinearSystems2.WorkInProgress.Tests.care"
>Modelica_LinearSystems2.WorkInProgress.Tests.care</A>.care5</H2>
<B>Example 5 from Benner benchmarks</B><p>
<P><H3>Information</H3></P>
Extends from <A HREF="file:///C:/Programme/Dymola 7.4 Alpha/Modelica/Library/Modelica 3.1/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A> (Icon for a function).
<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>String</TD><TD>outputFile</TD><TD>&quot;&quot;</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>X1[9, 9]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>X2[9, 9]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>X3[9, 9]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku1</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku2</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku3</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> care5 <font color="darkgreen">&quot;Example 5 from Benner benchmarks&quot;</font>
  <font color="blue">extends </font><A HREF="file:///C:/Programme/Dymola 7.4 Alpha/Modelica/Library/Modelica 3.1/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A>;
  <font color="blue">import </font><A HREF="Modelica_LinearSystems2_Math_Matrices.html#Modelica_LinearSystems2.Math.Matrices"
>Modelica_LinearSystems2.Math.Matrices</A>;
  <font color="blue">input </font>String outputFile = &quot;&quot;;

<font color="blue">protected </font>
  Real A[9,9]=[-4.019,    5.120,   0.0,   0.0,  -2.082,   0.0,  0.0,   0.0,   8.700e-01;
               -3.460e-01,    9.860e-01,   0.0,   0.0,  -2.340,   0.0,  0.0,   0.0,   9.700e-01;
               -7.909,   1.5407e+01,  -4.069,   0.0,  -6.450,   0.0,  0.0,   0.0,   2.680;
               -2.1816e+01,  3.5606e+01,  -3.390e-01,  -3.870,  -1.780e+01,   0.0,  0.0,   0.0,   7.390;
               -6.0196e+01,  9.8188e+01,  -7.907,   3.400e-01,  -5.3008e+01,  0.0,  0.0,   0.0,   2.040e+01;
                0.0,    0.0,   0.0,   0.0,   9.400e+01,  -1.472e+02,  0.0,   5.320e+01,   0.0;
                0.0,    0.0,   0.0,   0.0,   0.0,   9.400e+01, -1.472e+02,   0.0,   0.0;
                0.0,    0.0,   0.0,   0.0,   0.0,   1.280e+01,  0.0,  -3.160e+01,   0.0;
                0.0,    0.0,   0.0,   0.0,   1.280e+01,   0.0,  0.0,   1.880e+01,  -3.160e+01];

  Real B[9,3]=[  0.0100,   -0.0110,   -0.1510;
                 0.0030,   -0.0210,         0;
                 0.0090,   -0.0590,         0;
                 0.0240,   -0.1620,         0;
                 0.0680,   -0.4450,         0;
                 0,         0,         0;
                 0,         0,         0;
                 0,         0,         0;
                 0,         0,         0];

  Real R[3,3]=<font color="red">identity</font>(3);
  Real Q[9,9]=<font color="red">identity</font>(9);
  Real G[9,9]=B*<font color="red">transpose</font>(B);
  Real H[18,18]=[A,-G; -Q,-<font color="red">transpose</font>(A)];
  Real condH=<font color="red">Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(
                                               H);
  Real normH=<font color="red">Matrices.norm</font>(H, 2);
  Real condX1;
  Real normX1;
  Real condX2;
  Real normX2;
  Real condX3;
  Real normX3;
  Real Qr1[9,9];
  Real Qr2[9,9];
  Real Qr3[9,9];
  Real deltaQ1;
  Real deltaQ2;
  Real deltaQ3;

<font color="blue">public </font>
  <font color="blue">output </font>Real X1[9,9]=<font color="red">Matrices.care</font>(A, B, R, Q, false);
  <font color="blue">output </font>Real X2[9,9]=<font color="red">Matrices.care</font>(A, B, R, Q, true);

  <font color="blue">output </font>Real X3[9,9]=[1.8813417073612682e+000,   3.9350887811241636e-001,   3.0066821723622605e-001,  -5.6646472831415537e-002,  -1.3921476885988587e-001,  -4.0430720912527553e-003,  -2.0593909138650463e-004,  -3.2846155476217977e-002,  -2.5012667587779286e-002;
                       3.9350887811241636e-001,   2.4445142440433059e+000,   2.9761009646012448e-001,   1.1904010124814599e-001,  -1.4000314732846808e-001,   8.6371528201907403e-003,   3.3855145579537928e-004,   7.6337899432566164e-002,   6.9126140585845194e-002;
                       3.0066821723622605e-001,   2.9761009646012448e-001,   2.5625289349920533e-001,   3.5608619331945784e-002,  -7.0291882601897213e-002,  -2.9479293666103855e-004,  -2.7109320576564369e-005,  -1.5876949090013865e-003,   6.6183235965156960e-004;
                      -5.6646472831415537e-002,   1.1904010124814599e-001,   3.5608619331945784e-002,   1.2531244600262245e-001,  -4.4098271439652045e-002,   2.8906009190787904e-004,   1.1585504034027231e-006,   3.3312522262940710e-003,   5.3504545840022469e-003;
                      -1.3921476885988587e-001,  -1.4000314732846808e-001,  -7.0291882601897213e-002,  -4.4098271439652045e-002,   5.0544674045016849e-002,   2.7384271164510657e-003,   5.1877285822234109e-004,   6.6383915326013159e-003,   5.1811830100945500e-003;
                      -4.0430720912527553e-003,   8.6371528201907403e-003,  -2.9479293666103855e-004,   2.8906009190787904e-004,   2.7384271164510657e-003,   4.4145119317543710e-003,   1.0990456156319732e-003,   3.6333616685830985e-003,   1.1417260453168568e-003;
                      -2.0593909138650463e-004,   3.3855145579537928e-004,  -2.7109320576564369e-005,   1.1585504034027231e-006,   5.1877285822234109e-004,   1.0990456156319732e-003,   3.3967389367722083e-003,   3.3327489291592403e-004,   5.9658514141889494e-005;
                      -3.2846155476217977e-002,   7.6337899432566164e-002,  -1.5876949090013865e-003,   3.3312522262940710e-003,   6.6383915326013159e-003,   3.6333616685830985e-003,   3.3327489291592403e-004,   2.8282052511283625e-002,   1.0661764834431937e-002;
                      -2.5012667587779286e-002,   6.9126140585845194e-002,   6.6183235965156960e-004,   5.3504545840022469e-003,   5.1811830100945500e-003,   1.1417260453168568e-003,   5.9658514141889494e-005,   1.0661764834431937e-002,   2.1907727243964663e-002];

  <font color="blue">output </font>Real ku1=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X1);
  <font color="blue">output </font>Real ku2=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X2);
  <font color="blue">output </font>Real ku3=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X3);
<font color="blue">algorithm </font>
  Qr1 := X1*G*X1-<font color="red">transpose</font>(A)*X1-X1*A;
  Qr2 := X2*G*X2-<font color="red">transpose</font>(A)*X2-X2*A;
  Qr3 := X3*G*X3-<font color="red">transpose</font>(A)*X3-X3*A;
  deltaQ1 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr1)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  deltaQ2 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr2)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  deltaQ3 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr3)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  condX1 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X1);
  normX1 :=<font color="red"> Matrices.norm</font>(X1, 2);
  condX2 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X2);
  normX2 :=<font color="red"> Matrices.norm</font>(X2, 2);
  condX3 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X3);
  normX3 :=<font color="red"> Matrices.norm</font>(X3, 2);

  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Solution X1 without subsequent Newton refinement&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X1, 16, &quot;X1&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Solution X2 with subsequent Newton refinement&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X2, 16, &quot;X2&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;MATLAB solution X3&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X3, 16, &quot;X3&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normH = &quot; +<font color="red"> String</font>(normH),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condH = &quot; +<font color="red"> String</font>(condH),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX1 = &quot; +<font color="red"> String</font>(normX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX1 = &quot; +<font color="red"> String</font>(condX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku1 = &quot; +<font color="red"> String</font>(ku1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX2 = &quot; +<font color="red"> String</font>(normX2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX2 = &quot; +<font color="red"> String</font>(condX2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku2 = &quot; +<font color="red"> String</font>(ku2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX3 = &quot; +<font color="red"> String</font>(normX3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX3 = &quot; +<font color="red"> String</font>(condX3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku3 = &quot; +<font color="red"> String</font>(ku3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ1 = &quot; +<font color="red"> String</font>(deltaQ1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ2 = &quot; +<font color="red"> String</font>(deltaQ2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ3 = &quot; +<font color="red"> String</font>(deltaQ3),outputFile);

<font color="blue">end </font>care5;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE care6<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Modelica_LinearSystems2.WorkInProgress.Tests.care.care1I.png" ALT="Modelica_LinearSystems2.WorkInProgress.Tests.care.care6" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Modelica_LinearSystems2.WorkInProgress.Tests.care.care6"></A><A HREF="Modelica_LinearSystems2_WorkInProgress_Tests_care.html#Modelica_LinearSystems2.WorkInProgress.Tests.care"
>Modelica_LinearSystems2.WorkInProgress.Tests.care</A>.care6</H2>
<B>Example 6 from Benner benchmarks</B><p>
<P><H3>Information</H3></P>
Extends from <A HREF="file:///C:/Programme/Dymola 7.4 Alpha/Modelica/Library/Modelica 3.1/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A> (Icon for a function).
<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>String</TD><TD>outputFile</TD><TD>&quot;&quot;</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>X1[30, 30]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>X2[30, 30]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>X3[30, 30]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku1</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku2</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku3</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> care6 <font color="darkgreen">&quot;Example 6 from Benner benchmarks&quot;</font>
  <font color="blue">extends </font><A HREF="file:///C:/Programme/Dymola 7.4 Alpha/Modelica/Library/Modelica 3.1/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A>;
  <font color="blue">import </font><A HREF="Modelica_LinearSystems2_Math_Matrices.html#Modelica_LinearSystems2.Math.Matrices"
>Modelica_LinearSystems2.Math.Matrices</A>;
  <font color="blue">input </font>String outputFile = &quot;&quot;;

<font color="blue">protected </font>
Real A[30,30]=[ -4.3280000000000003e+000,  1.7140000000000000e-001,  5.3760000000000003e+000,  4.0160000000000002e+002, -7.2460000000000002e+002, -1.9330000000000001e+000,  1.0200000000000000e+000, -9.8199999999999998e-001,  9.9900000000000000e-001,  1.5209999999999999e+000, -4.0620000000000003e+000,  9.5670000000000002e+000,  1.0080000000000000e+001, -6.0170000000000001e-001, -1.3120000000000001e-001,  9.6019999999999994e-002, -4.5699999999999998e-002,  0.0000000000000000e+000, -4.5160000000000002e+002,  0.0000000000000000e+000,  0.0000000000000000e+000, -1.0580000000000000e+002,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000;
 -4.4019999999999998e-001, -5.6429999999999998e+000,  1.2750000000000000e+002, -2.3350000000000000e+002, -4.3430000000000001e+002,  2.6590000000000000e+001,  2.0400000000000000e+000, -2.5920000000000001e+000,  1.1320000000000000e+001,  1.0900000000000000e+001, -4.0709999999999997e+000, -5.7389999999999997e-002, -6.0629999999999995e-001, -7.4880000000000002e-002, -5.9360000000000002e-001, -9.6019999999999994e-002,  1.1140000000000000e-001,  0.0000000000000000e+000, -5.4610000000000002e+002,  0.0000000000000000e+000,  0.0000000000000000e+000, -6.5750000000000002e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000;
  1.0380000000000000e+000,  6.0730000000000004e+000, -1.6500000000000000e+002, -4.4829999999999997e+000,  1.0490000000000000e+003, -8.2450000000000003e+001, -5.3140000000000001e+000,  5.0970000000000004e+000, -9.3889999999999998e-003,  1.3519999999999999e-001,  5.6379999999999999e+000,  2.2460000000000001e-002,  1.7970000000000000e-001,  2.4070000000000001e-002,  1.1000000000000001e+000,  2.7430000000000000e-002,  2.1529999999999999e-001,  0.0000000000000000e+000,  1.3620000000000000e+003,  0.0000000000000000e+000,  0.0000000000000000e+000,  1.3460000000000001e+001,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000;
  5.3039999999999998e-001, -1.0860000000000000e-001,  1.3130000000000001e+002, -5.7829999999999995e+002,  1.0200000000000000e+002, -9.2400000000000002e+000, -1.1459999999999999e+000, -2.4079999999999999e+000, -3.0810000000000000e+000, -4.5289999999999999e+000,  5.7069999999999999e+000, -2.3460000000000000e-001, -2.1110000000000002e+000, -2.4600000000000000e-001, -4.6860000000000002e-001, -3.2229999999999998e-001,  3.2619999999999999e-001,  0.0000000000000000e+000,  2.0800000000000000e+002,  0.0000000000000000e+000,  0.0000000000000000e+000, -2.8879999999999999e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000;
  8.4759999999999992e-003, -1.5630000000000002e-002,  5.6020000000000000e-002,  1.5730000000000000e+000, -1.0050000000000001e+001,  1.9520000000000001e-001, -8.8039999999999993e-003, -2.1100000000000001e-002,  2.0899999999999998e-003, -5.2560000000000003e-002, -4.0770000000000001e-002, -9.1819999999999992e-003, -5.1780000000000000e-002,  3.4250000000000003e-002,  4.9950000000000003e-003, -1.2560000000000000e-002,  9.9480000000000002e-003,  0.0000000000000000e+000, -9.8390000000000001e+001,  0.0000000000000000e+000,  0.0000000000000000e+000,  5.0690000000000002e-001,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000;
  8.3499999999999996e-001, -1.2489999999999999e-002, -3.5670000000000000e-002, -6.0740000000000005e-001,  3.7649999999999999e+001, -1.9789999999999999e+001, -1.8129999999999999e-001, -2.9520000000000001e-002, -1.9529999999999999e-002, -1.6220000000000001e-001, -6.4390000000000003e-003, -2.3460000000000002e-002, -2.2009999999999999e-001, -2.5139999999999999e-002, -3.7490000000000002e-003, -3.3509999999999998e-002,  2.7279999999999999e-002,  0.0000000000000000e+000,  7.1620000000000005e+001,  0.0000000000000000e+000,  0.0000000000000000e+000,  9.6080000000000005e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000;
  6.7679999999999996e-001, -1.2640000000000000e-002, -9.6829999999999999e-002, -3.5670000000000002e-001,  8.0239999999999995e+001, -8.2390000000000005e-002, -2.0469999999999999e+001, -3.9280000000000002e-002,  1.8780000000000002e-002, -2.1290000000000001e-001, -9.3369999999999998e-003, -3.1440000000000003e-002, -2.9189999999999999e-001, -3.3700000000000001e-002,  8.8730000000000003e-002, -4.4580000000000002e-002,  1.7160000000000002e-002,  0.0000000000000000e+000,  7.1709999999999994e+001,  0.0000000000000000e+000,  0.0000000000000000e+000,  8.5709999999999997e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000;
 -9.6960000000000005e-002,  8.6660000000000004e-001,  1.6870000000000001e+001,  1.0509999999999999e+000, -1.0230000000000000e+002,  2.9660000000000000e+001,  5.9430000000000005e-001, -1.9969999999999999e+001,  2.2530000000000001e-002,  1.7010000000000000e-001,  8.3710000000000000e-003,  2.6450000000000001e-002,  2.5600000000000001e-001,  2.8350000000000000e-002, -3.7490000000000002e-002,  3.6350000000000000e-002, -7.7410000000000007e-002,  0.0000000000000000e+000, -1.4119999999999999e+002,  0.0000000000000000e+000,  0.0000000000000000e+000, -8.2150000000000001e-001,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000;
 -8.7849999999999994e-003, -1.6360000000000000e-002,  1.8470000000000000e-001,  2.1690000000000001e-001, -8.4199999999999999e+000,  7.0030000000000003e-001,  5.6660000000000002e-002,  6.6230000000000002e+000, -4.9990000000000002e+001,  6.7599999999999993e-002,  3.9460000000000001e+001,  4.9909999999999998e-003,  8.9829999999999993e-002,  5.3489999999999996e-003,  0.0000000000000000e+000,  1.3720000000000000e-002,  3.8550000000000001e-002,  0.0000000000000000e+000, -7.7100000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000, -4.3709999999999999e-002,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000;
 -1.2980000000000001e-004, -2.4300000000000000e-004,  2.7179999999999999e-003,  3.2139999999999998e-003, -1.2460000000000000e-001,  1.0370000000000001e-002,  8.3949999999999997e-004,  9.8119999999999999e-002, -6.6659999999999997e-001, -6.6569999999999996e-001,  5.8470000000000000e-001,  6.6539999999999997e-005,  1.3470000000000001e-003,  7.1310000000000007e-005,  0.0000000000000000e+000,  2.0570000000000001e-004,  5.7070000000000005e-004,  0.0000000000000000e+000, -1.1440000000000000e-001,  0.0000000000000000e+000,  0.0000000000000000e+000, -6.3590000000000001e-004,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000;
 -1.2070000000000001e+000, -6.7169999999999996e+000,  2.6260000000000002e+001,  1.2490000000000000e+001, -1.2690000000000000e+003,  1.0300000000000000e+002,  7.4800000000000004e+000,  3.6840000000000003e+001,  2.8539999999999999e-001,  2.3319999999999999e+000, -4.7649999999999999e+001,  3.4060000000000001e-001,  3.0649999999999999e+000,  3.6240000000000000e-001, -4.3430000000000002e-001,  4.6810000000000002e-001,  5.7270000000000003e+000,  0.0000000000000000e+000, -1.7450000000000000e+003,  0.0000000000000000e+000,  0.0000000000000000e+000, -8.9399999999999995e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000;
 -2.7300000000000001e-002, -4.5390000000000003e-001, -5.2719999999999999e+001,  1.9880000000000001e+002, -2.8090000000000000e+001,  2.2429999999999999e+000,  1.7940000000000000e-001,  9.7500000000000000e+000, -9.6270000000000007e+000, -9.5570000000000004e+000,  3.8479999999999997e+001, -5.0009999999999998e+001,  1.0110000000000000e-001,  1.2030000000000001e-002, -4.6859999999999999e-002,  1.7149999999999999e-002,  1.3919999999999999e-001,  0.0000000000000000e+000, -2.4300000000000001e+001,  0.0000000000000000e+000,  0.0000000000000000e+000, -2.7360000000000001e-001,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000;
 -1.2060000000000000e-003, -2.0170000000000000e-002, -2.3430000000000000e+000,  8.8350000000000009e+000, -1.2480000000000000e+000,  9.9750000000000005e-002,  8.0590000000000002e-003,  4.3330000000000002e-001, -4.2780000000000001e-001, -4.2449999999999999e-001,  1.7100000000000000e+000, -2.0000000000000000e+000, -1.9960000000000000e+000,  5.3490000000000005e-004, -1.9989999999999999e-003,  7.5440000000000001e-004,  6.1720000000000004e-003,  0.0000000000000000e+000, -1.0820000000000001e+000,  0.0000000000000000e+000,  0.0000000000000000e+000, -1.1830000000000000e-002,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000;
 -1.6130000000000000e-001, -2.4690000000000001e-001, -2.4050000000000001e+001,  2.3379999999999999e+001,  1.4830000000000001e+002,  1.6379999999999999e+000,  1.3850000000000001e-001,  4.4880000000000004e+000, -4.4139999999999997e+000, -4.3540000000000001e+000,  1.7660000000000000e+001, -3.1130000000000000e+000, -3.0179999999999998e+000, -1.9770000000000000e+001, -4.9990000000000000e-002,  1.5089999999999999e-002,  6.7769999999999997e-002,  0.0000000000000000e+000,  1.6600000000000001e+001,  0.0000000000000000e+000,  0.0000000000000000e+000,  3.9800000000000002e-001,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000;
 -1.2440000000000000e-002,  3.0200000000000001e-002, -1.1980000000000000e-001, -4.8210000000000003e-002,  5.5750000000000002e+000, -4.5250000000000001e-001,  1.9809999999999999e+001,  1.2490000000000000e-001, -1.1270000000000000e-003, -6.7600000000000004e-003,  1.8350000000000002e-002, -9.9810000000000003e-004, -1.3469999999999999e-002, -1.0700000000000000e-003, -2.0000000000000000e+001, -2.0569999999999998e-003,  1.8799999999999999e-003,  0.0000000000000000e+000,  9.1470000000000002e+000,  0.0000000000000000e+000,  0.0000000000000000e+000, -8.2410000000000005e-001,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000;
 -1.6530000000000000e+000,  1.8310000000000000e+000, -3.8220000000000001e+000,  1.1340000000000001e+002,  3.4139999999999998e+002, -2.7340000000000000e+001, -2.0400000000000000e+000, -6.1660000000000004e-001,  5.0039999999999996e-001, -1.4369999999999999e-001, -2.4159999999999999e+000, -1.0730000000000001e-001, -1.0780000000000001e+000,  3.0530000000000001e+001,  1.9890000000000001e+001, -5.0159999999999997e+001,  1.6769999999999999e-001,  0.0000000000000000e+000,  4.3580000000000001e+002,  0.0000000000000000e+000,  0.0000000000000000e+000, -5.9939999999999998e+001,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000;
  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  1.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000;
  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000, -5.0000000000000000e+002, -6.0000000000000000e+001,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000;
  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  1.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000;
  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  1.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000;
  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000, -3.6000000000000000e+003, -7.0800000000000000e+002, -1.0672000000000000e+002,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000;
  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  1.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000;
  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  1.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000;
  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000, -1.2000000000000000e+004, -5.2400000000000000e+003, -1.5000000000000000e+002,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000;
  3.3299999999999997e+001,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000, -3.3299999999999997e+001,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000;
  0.0000000000000000e+000,  2.0000000000000000e+001,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000, -2.0000000000000000e+001,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000;
  0.0000000000000000e+000,  0.0000000000000000e+000,  2.0000000000000000e+001,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000, -2.0000000000000000e+001,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000;
  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  2.0000000000000000e+001,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000, -2.0000000000000000e+001,  0.0000000000000000e+000,  0.0000000000000000e+000;
  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  6.4500000000000002e-001,  6.4500000000000002e-001,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  1.0000000000000000e+000;
  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000, -8.9400000000000002e-001, -8.9400000000000002e-001,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000,  0.0000000000000000e+000, -3.0599999999999999e-001, -1.8600000000000001e+000];

  Real B[30,3]=[0.0,  0.0,  0.0;
                0.0,  0.0,  0.0;
                0.0,  0.0,  0.0;
                0.0,  0.0,  0.0;
                0.0,  0.0,  0.0;
                0.0,  0.0,  0.0;
                0.0,  0.0,  0.0;
                0.0,  0.0,  0.0;
                0.0,  0.0,  0.0;
                0.0,  0.0,  0.0;
                0.0,  0.0,  0.0;
                0.0,  0.0,  0.0;
                0.0,  0.0,  0.0;
                0.0,  0.0,  0.0;
                0.0,  0.0,  0.0;
                0.0,  0.0,  0.0;
                0.0,  0.0,  0.0;
                5.000e+02,  0.0,  0.0;
                0.0,  0.0,  0.0;
                0.0,  0.0,  0.0;
                0.0,  3.600e+03,  0.0;
                0.0,  0.0,  0.0;
                0.0,  0.0,  0.0;
                0.0,  0.0,  1.200e+04;
                0.0,  0.0,  0.0;
                0.0,  0.0,  0.0;
                0.0,  0.0,  0.0;
                0.0,  0.0,  0.0;
                0.0,  0.0,  0.0;
                0.0,  0.0,  0.0];

  Real C[5,30]=[4.865e-01,   -6.741e-01,   5.392e+00,   9.542e+01,   2.403e+01,   1.052e+01,   8.190e-01,   -4.492e-01,   5.195e-01,   8.437e-01,   -1.863e+00,   5.709e-02,   4.815e-01,   3.428e+00,   2.161e+00,   7.681e-02,   -6.777e-02,   0.000e+00,   -4.205e+02,   0.000e+00,   0.000e+00,   3.297e+01,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00;
                1.383e-02,   2.789e-06,   0.000e+00,   0.000e+00,   -1.081e-02,   -5.545e-05,   4.722e-05,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   1.282e-04,   0.000e+00,   3.353e-01,   0.000e+00,   0.000e+00,   6.804e-01,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00;
                0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   1.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00;
                7.418e-05,   5.496e-06,   4.790e-06,   1.478e-04,   -1.504e-02,   -6.503e-05,   8.820e-05,   4.999e-06,   3.434e-06,   2.727e-05,   1.128e-06,   4.002e-06,   3.673e-05,   4.290e-06,   -4.958e-06,   5.609e-06,   1.030e-06,   0.000e+00,   -1.193e-02,   0.000e+00,   0.000e+00,   -5.806e-03,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00;
                1.538e-05,   1.201e-04,   -2.579e-03,   -1.609e-04,   1.618e-02,   -1.071e-03,   -9.561e-05,   -5.503e-06,   -3.732e-06,   -2.996e-05,   -1.234e-06,   -4.380e-06,   -4.024e-05,   -4.721e-06,   5.324e-06,   -6.103e-06,   8.109e-06,   0.000e+00,   2.328e-02,   0.000e+00,   0.000e+00,   1.178e-04,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00,   0.000e+00];

  Real R[3,3]=<font color="red">identity</font>(3);
  Real G[30,30]=B*<font color="red">transpose</font>(B);
  Real Q[30,30]=<font color="red">transpose</font>(C)*C;
  Real H[60,60]=[A,-G; -Q,-<font color="red">transpose</font>(A)];
  Real condH=<font color="red">Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(
                                               H);
  Real normH=<font color="red">Matrices.norm</font>(H, 2);
  Real condX1;
  Real normX1;
  Real condX2;
  Real normX2;
  Real condX3;
  Real normX3;
  Real Qr1[30,30];
  Real Qr2[30,30];
  Real Qr3[30,30];
  Real deltaQ1;
  Real deltaQ2;
  Real deltaQ3;

<font color="blue">public </font>
  <font color="blue">output </font>Real X1[30,30]=<font color="red">Matrices.care</font>(A, B, R, Q, false);
  <font color="blue">output </font>Real X2[30,30]=<font color="red">Matrices.care</font>(A, B, R, Q, true);

  <font color="blue">output </font>Real X3[30,30]=[1.1314520623027671e-002,    -1.6107914360228366e-004,     1.0125148710909534e-001,     1.0607123005840252e-001,     2.1391559007082854e+000,    -5.3013044708812972e-003,     5.9603743184771987e-003,     1.2610227664547665e-003,    -1.8717987377899620e-003,    -2.2561160424941010e-003,     4.3035170075349603e-003,    -2.5751944752821143e-004,     3.8311953516901812e-003,     4.0709208507935232e-002,     2.6300093602768280e-002,     2.8084085764500964e-005,     1.2633130362166875e-003,     1.6212991928128692e-005,    -5.1700691175234459e+000,    -4.5965796496117969e-002,    -1.7055974012332117e-004,     5.2107653698599132e-001,     5.9039810386038675e-003,     2.5781927216810587e-005,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     2.4731346392712914e-017,     3.7509607815033465e-017;
 -1.6107914360228366e-004,     2.4157491443241299e-003,    -3.2015766997613423e-002,    -8.8611325180730505e-002,     2.0141819898897190e-001,    -2.9451273326253597e-002,    -1.2693648726770927e-003,     1.5429066365809621e-006,    -4.8199235070527200e-004,    -4.2314522845959585e-004,     2.2994568213888407e-003,    -1.6356714154880224e-004,     1.0219174671594854e-003,    -4.1220288115707635e-003,    -2.5065447083500387e-003,    -1.3947453543740917e-004,    -1.8676072818446309e-004,    -4.8969478986915494e-006,     9.6931093362681714e-002,    -7.6817208964863777e-003,    -3.9910154909747358e-005,    -2.8605378636211883e-002,     6.7748306797468414e-004,     3.6373384941241013e-006,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     1.3179862066559472e-017,     4.7702183721099802e-017;
  1.0125148710909534e-001,    -3.2015766997613423e-002,     1.6946402727294536e+000,     2.1689040043683305e+000,     1.8200749429328468e+001,     3.2026263570129376e-001,     6.1686357494969521e-002,    -5.4538715472363025e-002,    -7.1987587851942989e-003,     8.0444533277696517e-003,    -2.0131282784866152e-002,    -1.3676697979232745e-003,     2.2054914447808181e-002,     4.6415276589845278e-001,     2.9675759466017282e-001,     2.3294992311815388e-003,    -9.6412126525501703e-004,    -5.9261469393990914e-006,    -5.0900402415947994e+001,    -2.9011103537033928e-001,    -7.8343817526871492e-004,     5.1720999078969827e+000,     3.0620099850064988e-002,     8.7291076709474888e-005,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     3.8422885438084180e-017,     8.1109719439219436e-018;
  1.0607123005840252e-001,    -8.8611325180730505e-002,     2.1689040043683305e+000,     8.0187244581683856e+000,     1.2250257082107950e+001,     1.2191665516829480e+000,     1.1209899571371032e-001,    -9.1570806309904440e-002,     3.1772422241598181e-002,     6.6417405731577728e-002,    -1.6913208871441468e-001,     3.6564604001257765e-003,     4.9615568185418048e-002,     5.9318281179557975e-001,     3.7425585653330884e-001,     7.3046185971569737e-003,    -6.2216264936675158e-003,     2.8678115354033595e-007,    -6.8740402318687273e+001,    -1.6406777542282691e-001,    -3.5710832825739156e-004,     6.0879545090596761e+000,     1.6436899492756271e-002,     4.2647265039928257e-005,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     5.7660849811843378e-018,    -9.9334334076166023e-018;
  2.1391559007082854e+000,     2.0141819898897190e-001,     1.8200749429328468e+001,     1.2250257082107950e+001,     5.0700363030881539e+002,    -5.9599971843770927e+000,     9.7331566850286644e-001,    -4.2576231507301759e-001,    -4.4991051789574699e-001,    -5.4208161930943799e-001,     1.0244367738498048e+000,    -9.5287660783881456e-002,    -2.0434385826631637e-002,     8.3767393504301388e+000,     5.4191661683840149e+000,    -1.4137965544241626e-002,     1.9018898400861954e-002,    -1.0729782670434202e-003,    -1.1451125418349934e+003,    -1.1245328874522540e+001,    -4.3154498600316601e-002,     1.0587639122248761e+002,     1.2002402403132373e+000,     4.8612476643694899e-003,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     4.4542517811037866e-015,    -2.5567826001282688e-015;
 -5.3013044708812972e-003,    -2.9451273326253597e-002,     3.2026263570129376e-001,     1.2191665516829480e+000,    -5.9599971843770927e+000,     4.5247717621080591e-001,     1.5087127330881068e-002,     1.3487883733422499e-002,     1.0272758284758272e-002,     2.2351016976336242e-002,    -3.5118523983982554e-002,     2.5573246671023193e-003,     1.7187359698277227e-002,     7.2088636470338495e-003,     2.5630163488559038e-003,     2.0386393485413200e-003,     5.8121455254000892e-003,     1.2856549386410188e-004,     4.7078806018554138e+000,     1.5807796912499550e-001,     7.0881843306397341e-004,    -1.9347778254501627e-001,    -1.4042129092639431e-002,    -6.0928879739184912e-005,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,    -1.0716432158645074e-016,     3.8143430366120274e-016;
  5.9603743184771987e-003,    -1.2693648726770927e-003,     6.1686357494969521e-002,     1.1209899571371032e-001,     9.7331566850286644e-001,     1.5087127330881068e-002,     4.3725367321334032e-003,     2.4771843170698690e-003,    -6.9156741696970749e-004,    -4.6353024965527988e-004,     1.7669001116361019e-003,    -7.7459933905512241e-005,     2.0855856066857928e-003,     2.2577974200174347e-002,     1.4472886109789182e-002,     7.6458860592387235e-005,     1.0992683470281641e-003,     1.4917372943272113e-005,    -3.0274139835655745e+000,    -2.5728660944654758e-002,    -1.0396755297956248e-004,     2.8582929235246757e-001,     3.1688779990072472e-003,     1.4931677407201184e-005,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     3.9951908089463261e-017,     1.5447036783328321e-016;
  1.2610227664547665e-003,     1.5429066365809621e-006,    -5.4538715472363025e-002,    -9.1570806309904440e-002,    -4.2576231507301759e-001,     1.3487883733422499e-002,     2.4771843170698690e-003,     1.8541549587043831e-002,    -1.1739686379868886e-003,    -1.3641288396525175e-003,     1.0899194969507028e-002,     8.8198574924541404e-005,     5.2918987571072135e-003,    -8.0927646089878815e-003,    -5.0062449818770571e-003,    -2.8270389757516259e-005,     4.2013086672945217e-003,     5.8539010643643644e-005,     8.1015487477043502e-001,    -5.7083939589918876e-003,    -4.9432902344155901e-005,    -1.9953589563148542e-002,     2.6225620906442674e-003,     1.8241863468107298e-005,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,    -9.3920344523586209e-017,     8.5685678733633103e-017;
 -1.8717987377899620e-003,    -4.8199235070527200e-004,    -7.1987587851942989e-003,     3.1772422241598181e-002,    -4.4991051789574699e-001,     1.0272758284758272e-002,    -6.9156741696970749e-004,    -1.1739686379868886e-003,     7.3899541882960999e-004,     9.7268447234455531e-004,    -2.4726592323675760e-003,     1.0065835583547995e-004,     2.3361694150332313e-004,    -5.7351498967773834e-003,    -3.7682315746656566e-003,     4.8588714689092320e-005,    -3.4209400054982931e-004,    -3.2295703852028390e-006,     8.0942947486176953e-001,     1.0803595672628539e-002,     4.2867756407817412e-005,    -8.4510736946567494e-002,    -1.3635257015676774e-003,    -6.1001444823862882e-006,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     1.6252774176231897e-017,     1.0721648367251547e-017;
 -2.2561160424941010e-003,    -4.2314522845959585e-004,     8.0444533277696517e-003,     6.6417405731577728e-002,    -5.4208161930943799e-001,     2.2351016976336242e-002,    -4.6353024965527988e-004,    -1.3641288396525175e-003,     9.7268447234455531e-004,     2.4221259678494450e-002,    -3.2559523370696095e-003,    -1.5119069001175210e-004,     5.7898205891273296e-003,    -3.7310667060018654e-003,    -2.5143955308998423e-003,     1.2797874890013814e-004,    -4.7589034336605203e-004,    -5.1154740454952569e-006,     9.9922335037105969e-001,     1.8663165933441611e-002,     8.8209981082483627e-005,    -9.3978774590296299e-002,    -2.5351467435352315e-003,    -1.3965611527607245e-005,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,    -2.4616766378584793e-015,     2.8690626416851757e-016;
  4.3035170075349603e-003,     2.2994568213888407e-003,    -2.0131282784866152e-002,    -1.6913208871441468e-001,     1.0244367738498048e+000,    -3.5118523983982554e-002,     1.7669001116361019e-003,     1.0899194969507028e-002,    -2.4726592323675760e-003,    -3.2559523370696095e-003,     2.0280733821810056e-002,    -3.4855177990517517e-004,     9.5848007720599989e-004,     8.8007348982472571e-003,     5.9773999569269071e-003,    -1.7933280651198050e-004,     2.1791300324801050e-003,     1.8386308223611988e-005,    -1.7239431161019216e+000,    -3.3695601389783121e-002,    -1.4600366102304421e-004,     1.7093735038587315e-001,     4.1808192799757740e-003,     1.9896273924677094e-005,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,    -1.0197508916769204e-017,     3.1404681324394296e-017;
 -2.5751944752821143e-004,    -1.6356714154880224e-004,    -1.3676697979232745e-003,     3.6564604001257765e-003,    -9.5287660783881456e-002,     2.5573246671023193e-003,    -7.7459933905512241e-005,     8.8198574924541404e-005,     1.0065835583547995e-004,    -1.5119069001175210e-004,    -3.4855177990517517e-004,     3.9954878482285753e-005,     2.0885241129553764e-005,    -1.1695768688093995e-003,    -7.6211234279950526e-004,     9.7432203911548479e-006,     3.9436204671319287e-005,     1.1882789523586905e-006,     1.8847885079438437e-001,     2.3234657621013289e-003,     9.3399676562331805e-006,    -1.4273403003222855e-002,    -1.7568117237244392e-004,    -5.7159845221000377e-007,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,    -5.6808449112854693e-018,     1.2676825063240146e-018;
  3.8311953516901812e-003,     1.0219174671594854e-003,     2.2054914447808181e-002,     4.9615568185418048e-002,    -2.0434385826631637e-002,     1.7187359698277227e-002,     2.0855856066857928e-003,     5.2918987571072135e-003,     2.3361694150332313e-004,     5.7898205891273296e-003,     9.5848007720599989e-004,     2.0885241129553764e-005,     1.4496225854746241e-002,     5.2615044640261848e-003,     3.4745198594603563e-003,     9.6332964170953172e-005,     1.9653086080665492e-003,     3.4402553803178094e-005,    -1.2011896200819400e-001,     4.5527324123781684e-003,     2.9933026083526343e-005,     7.4309997819240914e-002,     1.0486050969080603e-003,     6.6835817627296278e-006,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     1.3627760920868991e-016,     1.7474147279208624e-016;
  4.0709208507935232e-002,    -4.1220288115707635e-003,     4.6415276589845278e-001,     5.9318281179557975e-001,     8.3767393504301388e+000,     7.2088636470338495e-003,     2.2577974200174347e-002,    -8.0927646089878815e-003,    -5.7351498967773834e-003,    -3.7310667060018654e-003,     8.8007348982472571e-003,    -1.1695768688093995e-003,     5.2615044640261848e-003,     1.6918386835510865e-001,     1.0887494987664253e-001,     3.2988128364902313e-004,     1.2668579203300753e-003,     5.1112562821432639e-006,    -2.0995713381307340e+001,    -1.6849980717144863e-001,    -5.9556245198296939e-004,     2.0331302535356479e+000,     1.8774543296634194e-002,     7.1908438162286107e-005,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     1.1764931107964995e-017,     1.4201186666442584e-017;
  2.6300093602768280e-002,    -2.5065447083500387e-003,     2.9675759466017282e-001,     3.7425585653330884e-001,     5.4191661683840149e+000,     2.5630163488559038e-003,     1.4472886109789182e-002,    -5.0062449818770571e-003,    -3.7682315746656566e-003,    -2.5143955308998423e-003,     5.9773999569269071e-003,    -7.6211234279950526e-004,     3.4745198594603563e-003,     1.0887494987664253e-001,     7.0085606717242843e-002,     2.0432359900814800e-004,     8.5967995543925237e-004,     3.8552948159692070e-006,    -1.3489243867616850e+001,    -1.0857170263947999e-001,    -3.8291689043109769e-004,     1.3104753634161017e+000,     1.2175588068605296e-002,     4.6665737216639170e-005,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,    -3.7395858037309767e-017,     2.7887822922726449e-017;
  2.8084085764500964e-005,    -1.3947453543740917e-004,     2.3294992311815388e-003,     7.3046185971569737e-003,    -1.4137965544241626e-002,     2.0386393485413200e-003,     7.6458860592387235e-005,    -2.8270389757516259e-005,     4.8588714689092320e-005,     1.2797874890013814e-004,    -1.7933280651198050e-004,     9.7432203911548479e-006,     9.6332964170953172e-005,     3.2988128364902313e-004,     2.0432359900814800e-004,     1.1522364469447503e-005,     8.3969766582294545e-006,     3.1009973634852648e-007,     2.0258199123508978e-003,     7.7542059420616970e-004,     4.1592812007601974e-006,     1.9066906678958215e-003,    -6.8655449071811678e-005,    -4.0633578246446710e-007,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,    -1.0857823245749045e-018,    -1.8919694970494328e-018;
  1.2633130362166875e-003,    -1.8676072818446309e-004,    -9.6412126525501703e-004,    -6.2216264936675158e-003,     1.9018898400861954e-002,     5.8121455254000892e-003,     1.0992683470281641e-003,     4.2013086672945217e-003,    -3.4209400054982931e-004,    -4.7589034336605203e-004,     2.1791300324801050e-003,     3.9436204671319287e-005,     1.9653086080665492e-003,     1.2668579203300753e-003,     8.5967995543925237e-004,     8.3969766582294545e-006,     1.1248843190088545e-003,     1.6848704256803877e-005,    -1.2631435243154646e-001,    -2.9062458146660239e-003,    -1.5177606081916443e-005,     3.5056718608943362e-002,     9.8721407362008370e-004,     6.0582024980891251e-006,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     3.0048892601270165e-017,     5.2687958070133744e-018;
  1.6212991928128692e-005,    -4.8969478986915494e-006,    -5.9261469393990914e-006,     2.8678115354033595e-007,    -1.0729782670434202e-003,     1.2856549386410188e-004,     1.4917372943272113e-005,     5.8539010643643644e-005,    -3.2295703852028390e-006,    -5.1154740454952569e-006,     1.8386308223611988e-005,     1.1882789523586905e-006,     3.4402553803178094e-005,     5.1112562821432639e-006,     3.8552948159692070e-006,     3.1009973634852648e-007,     1.6848704256803877e-005,     2.7348013246573624e-007,     1.4000978172497831e-003,     6.0454240473467485e-006,    -3.3471593867896176e-009,     3.3349675177426119e-004,     1.1399384893671311e-005,     7.7322807067334181e-008,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     4.9233696788889253e-019,     1.1189639290919407e-019;
 -5.1700691175234459e+000,     9.6931093362681714e-002,    -5.0900402415947994e+001,    -6.8740402318687273e+001,    -1.1451125418349934e+003,     4.7078806018554138e+000,    -3.0274139835655745e+000,     8.1015487477043502e-001,     8.0942947486176953e-001,     9.9922335037105969e-001,    -1.7239431161019216e+000,     1.8847885079438437e-001,    -1.2011896200819400e-001,    -2.0995713381307340e+001,    -1.3489243867616850e+001,     2.0258199123508978e-003,    -1.2631435243154646e-001,     1.4000978172497831e-003,     3.1063068982509326e+003,     3.0809068577522883e+001,     1.3037089944501426e-001,    -2.6314565449024428e+002,    -2.9298475965462991e+000,    -1.2725789141350191e-002,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,    -4.3557104966212494e-015,     2.2389774180420039e-015;
 -4.5965796496117969e-002,    -7.6817208964863777e-003,    -2.9011103537033928e-001,    -1.6406777542282691e-001,    -1.1245328874522540e+001,     1.5807796912499550e-001,    -2.5728660944654758e-002,    -5.7083939589918876e-003,     1.0803595672628539e-002,     1.8663165933441611e-002,    -3.3695601389783121e-002,     2.3234657621013289e-003,     4.5527324123781684e-003,    -1.6849980717144863e-001,    -1.0857170263947999e-001,     7.7542059420616970e-004,    -2.9062458146660239e-003,     6.0454240473467485e-006,     3.0809068577522883e+001,     4.1484603360400596e-001,     2.0606238804963869e-003,    -2.3134609524667074e+000,    -3.3569911851717649e-002,    -1.5964177205051195e-004,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,    -5.6694198840441077e-017,     2.1878965010101277e-017;
 -1.7055974012332117e-004,    -3.9910154909747358e-005,    -7.8343817526871492e-004,    -3.5710832825739156e-004,    -4.3154498600316601e-002,     7.0881843306397341e-004,    -1.0396755297956248e-004,    -4.9432902344155901e-005,     4.2867756407817412e-005,     8.8209981082483627e-005,    -1.4600366102304421e-004,     9.3399676562331805e-006,     2.9933026083526343e-005,    -5.9556245198296939e-004,    -3.8291689043109769e-004,     4.1592812007601974e-006,    -1.5177606081916443e-005,    -3.3471593867896176e-009,     1.3037089944501426e-001,     2.0606238804963869e-003,     1.1257646479250110e-005,    -8.6808443683323994e-003,    -1.4383979506220649e-004,    -7.2617348783136431e-007,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,    -2.6920650566938837e-019,     3.6924816915117691e-020;
  5.2107653698599132e-001,    -2.8605378636211883e-002,     5.1720999078969827e+000,     6.0879545090596761e+000,     1.0587639122248761e+002,    -1.9347778254501627e-001,     2.8582929235246757e-001,    -1.9953589563148542e-002,    -8.4510736946567494e-002,    -9.3978774590296299e-002,     1.7093735038587315e-001,    -1.4273403003222855e-002,     7.4309997819240914e-002,     2.0331302535356479e+000,     1.3104753634161017e+000,     1.9066906678958215e-003,     3.5056718608943362e-002,     3.3349675177426119e-004,    -2.6314565449024428e+002,    -2.3134609524667074e+000,    -8.6808443683323994e-003,     2.5401068405580375e+001,     2.6905064473872486e-001,     1.1264445861486410e-003,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,    -3.3079348743294432e-016,    -9.2375448564113312e-017;
  5.9039810386038675e-003,     6.7748306797468414e-004,     3.0620099850064988e-002,     1.6436899492756271e-002,     1.2002402403132373e+000,    -1.4042129092639431e-002,     3.1688779990072472e-003,     2.6225620906442674e-003,    -1.3635257015676774e-003,    -2.5351467435352315e-003,     4.1808192799757740e-003,    -1.7568117237244392e-004,     1.0486050969080603e-003,     1.8774543296634194e-002,     1.2175588068605296e-002,    -6.8655449071811678e-005,     9.8721407362008370e-004,     1.1399384893671311e-005,    -2.9298475965462991e+000,    -3.3569911851717649e-002,    -1.4383979506220649e-004,     2.6905064473872486e-001,     4.1179358828019189e-003,     2.0167722981492082e-005,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,    -1.3162833585273572e-017,    -4.9958044693886117e-018;
  2.5781927216810587e-005,     3.6373384941241013e-006,     8.7291076709474888e-005,     4.2647265039928257e-005,     4.8612476643694899e-003,    -6.0928879739184912e-005,     1.4931677407201184e-005,     1.8241863468107298e-005,    -6.1001444823862882e-006,    -1.3965611527607245e-005,     1.9896273924677094e-005,    -5.7159845221000377e-007,     6.6835817627296278e-006,     7.1908438162286107e-005,     4.6665737216639170e-005,    -4.0633578246446710e-007,     6.0582024980891251e-006,     7.7322807067334181e-008,    -1.2725789141350191e-002,    -1.5964177205051195e-004,    -7.2617348783136431e-007,     1.1264445861486410e-003,     2.0167722981492082e-005,     1.0624744775475083e-007,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,    -9.5123461457722745e-020,    -2.6768544836468317e-020;
  0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000;
  0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000;
  0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000;
  0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000;
  2.4731346392712914e-017,     1.3179862066559472e-017,     3.8422885438084180e-017,     5.7660849811843378e-018,     4.4542517811037866e-015,    -1.0716432158645074e-016,     3.9951908089463261e-017,    -9.3920344523586209e-017,     1.6252774176231897e-017,    -2.4616766378584793e-015,    -1.0197508916769204e-017,    -5.6808449112854693e-018,     1.3627760920868991e-016,     1.1764931107964995e-017,    -3.7395858037309767e-017,    -1.0857823245749045e-018,     3.0048892601270165e-017,     4.9233696788889253e-019,    -4.3557104966212494e-015,    -5.6694198840441077e-017,    -2.6920650566938837e-019,    -3.3079348743294432e-016,    -1.3162833585273572e-017,    -9.5123461457722745e-020,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000;
  3.7509607815033465e-017,     4.7702183721099802e-017,     8.1109719439219436e-018,    -9.9334334076166023e-018,    -2.5567826001282688e-015,     3.8143430366120274e-016,     1.5447036783328321e-016,     8.5685678733633103e-017,     1.0721648367251547e-017,     2.8690626416851757e-016,     3.1404681324394296e-017,     1.2676825063240146e-018,     1.7474147279208624e-016,     1.4201186666442584e-017,     2.7887822922726449e-017,    -1.8919694970494328e-018,     5.2687958070133744e-018,     1.1189639290919407e-019,     2.2389774180420039e-015,     2.1878965010101277e-017,     3.6924816915117691e-020,    -9.2375448564113312e-017,    -4.9958044693886117e-018,    -2.6768544836468317e-020,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000,     0.0000000000000000e+000];
  <font color="blue">output </font>Real ku1=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X1);
  <font color="blue">output </font>Real ku2=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X2);
  <font color="blue">output </font>Real ku3=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X3);
<font color="blue">algorithm </font>
  Qr1 := X1*G*X1-<font color="red">transpose</font>(A)*X1-X1*A;
  Qr2 := X2*G*X2-<font color="red">transpose</font>(A)*X2-X2*A;
  Qr3 := X3*G*X3-<font color="red">transpose</font>(A)*X3-X3*A;
  deltaQ1 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr1)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  deltaQ2 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr2)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  deltaQ3 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr3)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  condX1 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X1);
  normX1 :=<font color="red"> Matrices.norm</font>(X1, 2);
  condX2 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X2);
  normX2 :=<font color="red"> Matrices.norm</font>(X2, 2);
  condX3 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X3);
  normX3 :=<font color="red"> Matrices.norm</font>(X3, 2);

  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Solution X1 without subsequent Newton refinement&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X1, 16, &quot;X1&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Solution X2 with subsequent Newton refinement&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X2, 16, &quot;X2&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;MATLAB solution X3&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X3, 16, &quot;X3&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normH = &quot; +<font color="red"> String</font>(normH),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condH = &quot; +<font color="red"> String</font>(condH),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX1 = &quot; +<font color="red"> String</font>(normX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX1 = &quot; +<font color="red"> String</font>(condX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku1 = &quot; +<font color="red"> String</font>(ku1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX2 = &quot; +<font color="red"> String</font>(normX2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX2 = &quot; +<font color="red"> String</font>(condX2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku2 = &quot; +<font color="red"> String</font>(ku2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX3 = &quot; +<font color="red"> String</font>(normX3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX3 = &quot; +<font color="red"> String</font>(condX3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku3 = &quot; +<font color="red"> String</font>(ku3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ1 = &quot; +<font color="red"> String</font>(deltaQ1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ2 = &quot; +<font color="red"> String</font>(deltaQ2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ3 = &quot; +<font color="red"> String</font>(deltaQ3),outputFile);

<font color="blue">end </font>care6;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE care7<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Modelica_LinearSystems2.WorkInProgress.Tests.care.care1I.png" ALT="Modelica_LinearSystems2.WorkInProgress.Tests.care.care7" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Modelica_LinearSystems2.WorkInProgress.Tests.care.care7"></A><A HREF="Modelica_LinearSystems2_WorkInProgress_Tests_care.html#Modelica_LinearSystems2.WorkInProgress.Tests.care"
>Modelica_LinearSystems2.WorkInProgress.Tests.care</A>.care7</H2>
<B>Example 7  from Benner benchmarks</B><p>
<P><H3>Information</H3></P>
Extends from <A HREF="file:///C:/Programme/Dymola 7.4 Alpha/Modelica/Library/Modelica 3.1/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A> (Icon for a function).
<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>String</TD><TD>outputFile</TD><TD>&quot;&quot;</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>X1[2, 2]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>X2[2, 2]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>X3[2, 2]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku1</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku2</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku3</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> care7 <font color="darkgreen">&quot;Example 7  from Benner benchmarks&quot;</font>
  <font color="blue">extends </font><A HREF="file:///C:/Programme/Dymola 7.4 Alpha/Modelica/Library/Modelica 3.1/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A>;
  <font color="blue">import </font><A HREF="Modelica_LinearSystems2_Math_Matrices.html#Modelica_LinearSystems2.Math.Matrices"
>Modelica_LinearSystems2.Math.Matrices</A>;
  <font color="blue">input </font>String outputFile = &quot;&quot;;

<font color="blue">protected </font>
  Real eps=1.0;
  Real A[2,2]=[1.0, 0.0; 0.0, -2.0];
  Real B[2,1]=[eps; 0.0];
  Real R[1,1]=[1];
  Real C[1,2]=[1, 1];
  Real G[2,2]=B*<font color="red">transpose</font>(B);
  Real Qtilde[1,1]=[1];
  Real Q[2,2]=<font color="red">transpose</font>(C)*Qtilde*C;
  Real h;
  Real Qr1[2,2];
  Real Qr2[2,2];
  Real Qr3[2,2];
  Real deltaQ1;
  Real deltaQ2;
  Real deltaQ3;
  Real H[4,4]=[A,-G; -Q,-<font color="red">transpose</font>(A)];
  Real condH=<font color="red">Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(
                                               H);
  Real normH=<font color="red">Matrices.norm</font>(H, 2);
  Real condX1;
  Real normX1;
  Real condX2;
  Real normX2;
  Real condX3;
  Real normX3;
  Real resX1;
  Real resX2;
<font color="blue">public </font>
  <font color="blue">output </font>Real X1[2,2];
  <font color="blue">output </font>Real X2[2,2];
  <font color="blue">output </font>Real X3[2,2];
  <font color="blue">output </font>Real ku1;
  <font color="blue">output </font>Real ku2;
  <font color="blue">output </font>Real ku3;

<font color="blue">algorithm </font>
<font color="darkgreen">// // solution for eps=1;</font>
<font color="darkgreen">//    X1:=Matrices.care(A, B, R, Q, false);</font>
<font color="darkgreen">//    X2:=Matrices.care(A, B, R, Q, true);</font>

<font color="darkgreen">//    h := sqrt(1+eps^2);</font>
<font color="darkgreen">//    X3:=[(1+h)/(eps^2), 1/(2+h); 1/(2+h), 0.25*(1-(eps^2)/((2+h)^2))];</font>
<font color="darkgreen">//   Qr1 := X1*G*X1-transpose(A)*X1-X1*A;</font>
<font color="darkgreen">//   Qr2 := X2*G*X2-transpose(A)*X2-X2*A;</font>
<font color="darkgreen">//   Qr3 := X3*G*X3-transpose(A)*X3-X3*A;</font>
<font color="darkgreen">//   deltaQ1 := Modelica.Math.Matrices.norm(Q-Qr1)/Modelica.Math.Matrices.norm(Q);</font>
<font color="darkgreen">//   deltaQ2 := Modelica.Math.Matrices.norm(Q-Qr2)/Modelica.Math.Matrices.norm(Q);</font>
<font color="darkgreen">//   deltaQ3 := Modelica.Math.Matrices.norm(Q-Qr3)/Modelica.Math.Matrices.norm(Q);</font>
<font color="darkgreen">//    ku1 := Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u(A, Q, G, X1);</font>
<font color="darkgreen">//    ku2 := Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u(A, Q, G, X2);</font>
<font color="darkgreen">//    ku3 := Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u(A, Q, G, X3);</font>
<font color="darkgreen">//    Modelica.Utilities.Streams.print(&quot;Solution X1 without subsequent Newton refinement&quot;);</font>
<font color="darkgreen">//    Matrices.printMatrix(X1, 16, &quot;X1&quot;);</font>
<font color="darkgreen">//    Modelica.Utilities.Streams.print(&quot;Solution X2 with subsequent Newton refinement&quot;);</font>
<font color="darkgreen">//    Matrices.printMatrix(X2, 16, &quot;X2&quot;);</font>
<font color="darkgreen">//    Modelica.Utilities.Streams.print(&quot;Exact solution X3&quot;);</font>
<font color="darkgreen">//    Matrices.printMatrix(X3, 16, &quot;X3&quot;);</font>
   eps := 1e-3;
   B:=[eps; 0.0];
   h :=<font color="red"> sqrt</font>(1+eps^2);
   X1:=<font color="red">Matrices.care</font>(A, B, R, Q, false);
   X2:=<font color="red">Matrices.care</font>(A, B, R, Q, true);
   X3:=[(1+h)/(eps^2), 1/(2+h); 1/(2+h), 0.25*(1-(eps^2)/(2+h))];
  Qr1 := X1*G*X1-<font color="red">transpose</font>(A)*X1-X1*A;
  Qr2 := X2*G*X2-<font color="red">transpose</font>(A)*X2-X2*A;
  Qr3 := X3*G*X3-<font color="red">transpose</font>(A)*X3-X3*A;
  deltaQ1 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr1)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  deltaQ2 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr2)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  deltaQ3 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr3)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  resX1 :=<font color="red"> Modelica.Math.Matrices.norm</font>(X1-X3)/<font color="red">Modelica.Math.Matrices.norm</font>(X3);
  resX2 :=<font color="red"> Modelica.Math.Matrices.norm</font>(X2-X3)/<font color="red">Modelica.Math.Matrices.norm</font>(X3);

   ku1 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X1);
   ku2 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X2);
   ku3 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X3);

  condX1 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X1);
  normX1 :=<font color="red"> Matrices.norm</font>(X1, 2);
  condX2 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X2);
  normX2 :=<font color="red"> Matrices.norm</font>(X2, 2);
  condX3 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X3);
  normX3 :=<font color="red"> Matrices.norm</font>(X3, 2);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Solution X1 without subsequent Newton refinement&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X1, 16, &quot;X1&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Solution X2 with subsequent Newton refinement&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X2, 16, &quot;X2&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Exact solution X3&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X3, 16, &quot;X3&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Residum of solution X1: resX1 = &quot;+<font color="red">String</font>(resX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Residum of solution X2: resX2 = &quot;+<font color="red">String</font>(resX2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normH = &quot; +<font color="red"> String</font>(normH),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condH = &quot; +<font color="red"> String</font>(condH),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX1 = &quot; +<font color="red"> String</font>(normX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX1 = &quot; +<font color="red"> String</font>(condX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku1 = &quot; +<font color="red"> String</font>(ku1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX2 = &quot; +<font color="red"> String</font>(normX2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX2 = &quot; +<font color="red"> String</font>(condX2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku2 = &quot; +<font color="red"> String</font>(ku2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX3 = &quot; +<font color="red"> String</font>(normX3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX3 = &quot; +<font color="red"> String</font>(condX3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku3 = &quot; +<font color="red"> String</font>(ku3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ1 = &quot; +<font color="red"> String</font>(deltaQ1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ2 = &quot; +<font color="red"> String</font>(deltaQ2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ3 = &quot; +<font color="red"> String</font>(deltaQ3),outputFile);
<font color="blue">end </font>care7;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE care8<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Modelica_LinearSystems2.WorkInProgress.Tests.care.care1I.png" ALT="Modelica_LinearSystems2.WorkInProgress.Tests.care.care8" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Modelica_LinearSystems2.WorkInProgress.Tests.care.care8"></A><A HREF="Modelica_LinearSystems2_WorkInProgress_Tests_care.html#Modelica_LinearSystems2.WorkInProgress.Tests.care"
>Modelica_LinearSystems2.WorkInProgress.Tests.care</A>.care8</H2>
<B>Example 8  from Benner benchmarks</B><p>
<P><H3>Information</H3></P>
Extends from <A HREF="file:///C:/Programme/Dymola 7.4 Alpha/Modelica/Library/Modelica 3.1/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A> (Icon for a function).
<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>String</TD><TD>outputFile</TD><TD>&quot;&quot;</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>X1[2, 2]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>X2[2, 2]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>X3[2, 2]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku1</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku2</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku3</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> care8 <font color="darkgreen">&quot;Example 8  from Benner benchmarks&quot;</font>
  <font color="blue">extends </font><A HREF="file:///C:/Programme/Dymola 7.4 Alpha/Modelica/Library/Modelica 3.1/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A>;
  <font color="blue">import </font><A HREF="Modelica_LinearSystems2_Math_Matrices.html#Modelica_LinearSystems2.Math.Matrices"
>Modelica_LinearSystems2.Math.Matrices</A>;
  <font color="blue">input </font>String outputFile = &quot;&quot;;

<font color="blue">protected </font>
  Real eps=1e-8;
  Real A[2,2]=[-0.1, 0.0; 0.0, -0.02];
  Real B[2,2]=[0.1, 0.0; 0.001, 0.01];
  Real R[2,2]=[1+eps, 1.0; 1.0, 1.0];
  Real C[1,2]=[10, 100];
  Real G[2,2]=B*<font color="red">transpose</font>(B);
  Real Qtilde[1,1]=[1];
  Real Q[2,2]=<font color="red">transpose</font>(C)*Qtilde*C;
  Real h;
  Real Qr1[2,2];
  Real Qr2[2,2];
  Real Qr3[2,2];
  Real deltaQ1;
  Real deltaQ2;
  Real deltaQ3;
  Real H[4,4]=[A,-G; -Q,-<font color="red">transpose</font>(A)];
  Real condH=<font color="red">Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(
                                               H);
  Real normH=<font color="red">Matrices.norm</font>(H, 2);
  Real condX1;
  Real normX1;
  Real condX2;
  Real normX2;
  Real condX3;
  Real normX3;

<font color="blue">public </font>
  <font color="blue">output </font>Real X1[2,2];
  <font color="blue">output </font>Real X2[2,2];
  <font color="blue">output </font>Real X3[2,2]=[7.4700062938350172e+001,   8.2995600931349986e+002;
                       8.2995600931349986e+002,   9.2213602958269603e+003];
  <font color="blue">output </font>Real ku1;
  <font color="blue">output </font>Real ku2;
  <font color="blue">output </font>Real ku3;

<font color="blue">algorithm </font>
  X1:=<font color="red">Matrices.care</font>(A, B, R, Q, false);
  X2:=<font color="red">Matrices.care</font>(A, B, R, Q, true);
  Qr1 := X1*G*X1-<font color="red">transpose</font>(A)*X1-X1*A;
  Qr2 := X2*G*X2-<font color="red">transpose</font>(A)*X2-X2*A;
  Qr3 := X3*G*X3-<font color="red">transpose</font>(A)*X3-X3*A;
  deltaQ1 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr1)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  deltaQ2 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr2)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  deltaQ3 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr3)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  h :=<font color="red"> sqrt</font>(1+eps^2);
  ku1:=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X1);
  ku2:=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X2);
  ku3:=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X3);

  condX1 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X1);
  normX1 :=<font color="red"> Matrices.norm</font>(X1, 2);
  condX2 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X2);
  normX2 :=<font color="red"> Matrices.norm</font>(X2, 2);
  condX3 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X3);
  normX3 :=<font color="red"> Matrices.norm</font>(X3, 2);

  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Solution X1 without subsequent Newton refinement&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X1, 16, &quot;X1&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Solution X2 with subsequent Newton refinement&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X2, 16, &quot;X2&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;MATLAB solution X3&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X3, 16, &quot;X3&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normH = &quot; +<font color="red"> String</font>(normH),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condH = &quot; +<font color="red"> String</font>(condH),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX1 = &quot; +<font color="red"> String</font>(normX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX1 = &quot; +<font color="red"> String</font>(condX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku1 = &quot; +<font color="red"> String</font>(ku1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX2 = &quot; +<font color="red"> String</font>(normX2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX2 = &quot; +<font color="red"> String</font>(condX2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku2 = &quot; +<font color="red"> String</font>(ku2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX3 = &quot; +<font color="red"> String</font>(normX3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX3 = &quot; +<font color="red"> String</font>(condX3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku3 = &quot; +<font color="red"> String</font>(ku3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ1 = &quot; +<font color="red"> String</font>(deltaQ1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ2 = &quot; +<font color="red"> String</font>(deltaQ2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ3 = &quot; +<font color="red"> String</font>(deltaQ3),outputFile);

<font color="blue">end </font>care8;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE care9<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Modelica_LinearSystems2.WorkInProgress.Tests.care.care1I.png" ALT="Modelica_LinearSystems2.WorkInProgress.Tests.care.care9" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Modelica_LinearSystems2.WorkInProgress.Tests.care.care9"></A><A HREF="Modelica_LinearSystems2_WorkInProgress_Tests_care.html#Modelica_LinearSystems2.WorkInProgress.Tests.care"
>Modelica_LinearSystems2.WorkInProgress.Tests.care</A>.care9</H2>
<B>Example 9  from Benner benchmarks</B><p>
<P><H3>Information</H3></P>
Extends from <A HREF="file:///C:/Programme/Dymola 7.4 Alpha/Modelica/Library/Modelica 3.1/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A> (Icon for a function).
<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>String</TD><TD>outputFile</TD><TD>&quot;&quot;</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>X1[2, 2]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>X2[2, 2]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>X3[2, 2]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku1</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku2</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku3</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> care9 <font color="darkgreen">&quot;Example 9  from Benner benchmarks&quot;</font>
  <font color="blue">extends </font><A HREF="file:///C:/Programme/Dymola 7.4 Alpha/Modelica/Library/Modelica 3.1/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A>;
  <font color="blue">import </font><A HREF="Modelica_LinearSystems2_Math_Matrices.html#Modelica_LinearSystems2.Math.Matrices"
>Modelica_LinearSystems2.Math.Matrices</A>;
  <font color="blue">input </font>String outputFile = &quot;&quot;;

<font color="blue">protected </font>
  Real eps=1e-6;
  Real h=<font color="red">sqrt</font>(1+2*eps);
  Real A[2,2]=[0.0, eps; 0.0, 0.0];
  Real B[2,1]=[0.0; 1.0];
  Real R[1,1]=[1];
  Real G[2,2]=B*<font color="red">transpose</font>(B);
  Real Q[2,2]=<font color="red">identity</font>(2);
  Real Qr1[2,2];
  Real Qr2[2,2];
  Real Qr3[2,2];
  Real deltaQ1;
  Real deltaQ2;
  Real deltaQ3;
  Real H[4,4]=[A,-G; -Q,-<font color="red">transpose</font>(A)];
  Real condH=<font color="red">Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(
                                               H);
  Real normH=<font color="red">Matrices.norm</font>(H, 2);
  Real condX1;
  Real normX1;
  Real condX2;
  Real normX2;
  Real condX3;
  Real normX3;
  Real resX1;
  Real resX2;

<font color="blue">public </font>
  <font color="blue">output </font>Real X1[2,2];
  <font color="blue">output </font>Real X2[2,2];
  <font color="blue">output </font>Real X3[2,2];

  <font color="blue">output </font>Real ku1;
  <font color="blue">output </font>Real ku2;
  <font color="blue">output </font>Real ku3;

<font color="blue">algorithm </font>
  X1:=<font color="red">Matrices.care</font>(A, B, R, Q, false);
  X2:=<font color="red">Matrices.care</font>(A, B, R, Q, true);
  X3:=[h/eps, 1; 1, h];
  Qr1 := X1*G*X1-<font color="red">transpose</font>(A)*X1-X1*A;
  Qr2 := X2*G*X2-<font color="red">transpose</font>(A)*X2-X2*A;
  Qr3 := X3*G*X3-<font color="red">transpose</font>(A)*X3-X3*A;
  deltaQ1 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr1)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  deltaQ2 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr2)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  deltaQ3 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr3)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  resX1 :=<font color="red"> Modelica.Math.Matrices.norm</font>(X1-X3)/<font color="red">Modelica.Math.Matrices.norm</font>(X3);
  resX2 :=<font color="red"> Modelica.Math.Matrices.norm</font>(X2-X3)/<font color="red">Modelica.Math.Matrices.norm</font>(X3);

   ku1:=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(
    A,
    Q,
    G,
    X1);
   ku2:=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(
    A,
    Q,
    G,
    X2);
   ku3:=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(
    A,
    Q,
    G,
    X3);

  condX1 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X1);
  normX1 :=<font color="red"> Matrices.norm</font>(X1, 2);
  condX2 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X2);
  normX2 :=<font color="red"> Matrices.norm</font>(X2, 2);
  condX3 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X3);
  normX3 :=<font color="red"> Matrices.norm</font>(X3, 2);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Solution X1 without subsequent Newton refinement&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X1, 16, &quot;X1&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Solution X2 with subsequent Newton refinement&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X2, 16, &quot;X2&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Exact solution X3&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X3, 16, &quot;X3&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Residum of solution X1: resX1 = &quot;+<font color="red">String</font>(resX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Residum of solution X2: resX2 = &quot;+<font color="red">String</font>(resX2),outputFile);

  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normH = &quot; +<font color="red"> String</font>(normH),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condH = &quot; +<font color="red"> String</font>(condH),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX1 = &quot; +<font color="red"> String</font>(normX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX1 = &quot; +<font color="red"> String</font>(condX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku1 = &quot; +<font color="red"> String</font>(ku1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX2 = &quot; +<font color="red"> String</font>(normX2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX2 = &quot; +<font color="red"> String</font>(condX2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku2 = &quot; +<font color="red"> String</font>(ku2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX3 = &quot; +<font color="red"> String</font>(normX3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX3 = &quot; +<font color="red"> String</font>(condX3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku3 = &quot; +<font color="red"> String</font>(ku3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ1 = &quot; +<font color="red"> String</font>(deltaQ1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ2 = &quot; +<font color="red"> String</font>(deltaQ2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ3 = &quot; +<font color="red"> String</font>(deltaQ3),outputFile);
<font color="blue">end </font>care9;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE care10<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Modelica_LinearSystems2.WorkInProgress.Tests.care.care1I.png" ALT="Modelica_LinearSystems2.WorkInProgress.Tests.care.care10" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Modelica_LinearSystems2.WorkInProgress.Tests.care.care10"></A><A HREF="Modelica_LinearSystems2_WorkInProgress_Tests_care.html#Modelica_LinearSystems2.WorkInProgress.Tests.care"
>Modelica_LinearSystems2.WorkInProgress.Tests.care</A>.care10</H2>
<B>Example 10  from Benner benchmarks</B><p>
<P><H3>Information</H3></P>
Extends from <A HREF="file:///C:/Programme/Dymola 7.4 Alpha/Modelica/Library/Modelica 3.1/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A> (Icon for a function).
<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>String</TD><TD>outputFile</TD><TD>&quot;&quot;</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>X1[2, 2]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>X2[2, 2]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>X3[2, 2]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku1</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku2</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku3</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> care10 <font color="darkgreen">&quot;Example 10  from Benner benchmarks&quot;</font>
  <font color="blue">extends </font><A HREF="file:///C:/Programme/Dymola 7.4 Alpha/Modelica/Library/Modelica 3.1/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A>;
  <font color="blue">import </font><A HREF="Modelica_LinearSystems2_Math_Matrices.html#Modelica_LinearSystems2.Math.Matrices"
>Modelica_LinearSystems2.Math.Matrices</A>;
  <font color="blue">input </font>String outputFile = &quot;&quot;;

<font color="blue">protected </font>
  Real eps=1e-7;
  Real h=1+eps;
  Real A[2,2]=[h, 1.0; 1.0, h];
  Real B[2,2]=<font color="red">identity</font>(2);
  Real R[2,2]=<font color="red">identity</font>(2);
  Real G[2,2]=B*<font color="red">transpose</font>(B);
  Real Q[2,2]=eps^2*<font color="red">identity</font>(2);
  Real x11=0.5*(2*h+<font color="red">sqrt</font>(2*h^2+2)+eps*<font color="red">sqrt</font>(2));
  Real x12=x11/(x11-h);
  Real Qr1[2,2];
  Real Qr2[2,2];
  Real Qr3[2,2];
  Real deltaQ1;
  Real deltaQ2;
  Real deltaQ3;
  Real H[4,4]=[A,-G; -Q,-<font color="red">transpose</font>(A)];
  Real condH=<font color="red">Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(
                                               H);
  Real normH=<font color="red">Matrices.norm</font>(H, 2);
  Real condX1;
  Real normX1;
  Real condX2;
  Real normX2;
  Real condX3;
  Real normX3;
  Real resX1;
  Real resX2;

<font color="blue">public </font>
  <font color="blue">output </font>Real X1[2,2];
  <font color="blue">output </font>Real X2[2,2];
  <font color="blue">output </font>Real X3[2,2];
  <font color="blue">output </font>Real ku1;
  <font color="blue">output </font>Real ku2;
  <font color="blue">output </font>Real ku3;

<font color="blue">algorithm </font>
  X1:=<font color="red">Matrices.care</font>(A, B, R, Q, false);
  X2:=<font color="red">Matrices.care</font>(A, B, R, Q, true);
  X3:=[x11, x12; x12, x11];
  Qr1 := X1*G*X1-<font color="red">transpose</font>(A)*X1-X1*A;
  Qr2 := X2*G*X2-<font color="red">transpose</font>(A)*X2-X2*A;
  Qr3 := X3*G*X3-<font color="red">transpose</font>(A)*X3-X3*A;
  deltaQ1 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr1)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  deltaQ2 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr2)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  deltaQ3 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr3)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  resX1 :=<font color="red"> Modelica.Math.Matrices.norm</font>(X1-X3)/<font color="red">Modelica.Math.Matrices.norm</font>(X3);
  resX2 :=<font color="red"> Modelica.Math.Matrices.norm</font>(X2-X3)/<font color="red">Modelica.Math.Matrices.norm</font>(X3);

  ku1:=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X1);
  ku2:=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X2);
  ku3:=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X3);

  condX1 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X1);
  normX1 :=<font color="red"> Matrices.norm</font>(X1, 2);
  condX2 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X2);
  normX2 :=<font color="red"> Matrices.norm</font>(X2, 2);
  condX3 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X3);
  normX3 :=<font color="red"> Matrices.norm</font>(X3, 2);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Solution X1 without subsequent Newton refinement&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X1, 16, &quot;X1&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Solution X2 with subsequent Newton refinement&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X2, 16, &quot;X2&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Exact solution X3&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X3, 16, &quot;X3&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Residum of solution X1: resX1 = &quot;+<font color="red">String</font>(resX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Residum of solution X2: resX2 = &quot;+<font color="red">String</font>(resX2),outputFile);

  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normH = &quot; +<font color="red"> String</font>(normH),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condH = &quot; +<font color="red"> String</font>(condH),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX1 = &quot; +<font color="red"> String</font>(normX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX1 = &quot; +<font color="red"> String</font>(condX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku1 = &quot; +<font color="red"> String</font>(ku1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX2 = &quot; +<font color="red"> String</font>(normX2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX2 = &quot; +<font color="red"> String</font>(condX2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku2 = &quot; +<font color="red"> String</font>(ku2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX3 = &quot; +<font color="red"> String</font>(normX3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX3 = &quot; +<font color="red"> String</font>(condX3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku3 = &quot; +<font color="red"> String</font>(ku3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ1 = &quot; +<font color="red"> String</font>(deltaQ1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ2 = &quot; +<font color="red"> String</font>(deltaQ2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ3 = &quot; +<font color="red"> String</font>(deltaQ3),outputFile);
<font color="blue">end </font>care10;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE care11<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Modelica_LinearSystems2.WorkInProgress.Tests.care.care1I.png" ALT="Modelica_LinearSystems2.WorkInProgress.Tests.care.care11" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Modelica_LinearSystems2.WorkInProgress.Tests.care.care11"></A><A HREF="Modelica_LinearSystems2_WorkInProgress_Tests_care.html#Modelica_LinearSystems2.WorkInProgress.Tests.care"
>Modelica_LinearSystems2.WorkInProgress.Tests.care</A>.care11</H2>
<B>Example 11  from Benner benchmarks</B><p>
<P><H3>Information</H3></P>
Extends from <A HREF="file:///C:/Programme/Dymola 7.4 Alpha/Modelica/Library/Modelica 3.1/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A> (Icon for a function).
<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>String</TD><TD>outputFile</TD><TD>&quot;&quot;</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>X1[2, 2]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>X2[2, 2]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>X3[2, 2]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku1</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku2</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku3</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> care11 <font color="darkgreen">&quot;Example 11  from Benner benchmarks&quot;</font>
  <font color="blue">extends </font><A HREF="file:///C:/Programme/Dymola 7.4 Alpha/Modelica/Library/Modelica 3.1/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A>;
  <font color="blue">import </font><A HREF="Modelica_LinearSystems2_Math_Matrices.html#Modelica_LinearSystems2.Math.Matrices"
>Modelica_LinearSystems2.Math.Matrices</A>;
  <font color="blue">input </font>String outputFile = &quot;&quot;;

<font color="blue">protected </font>
  Real eps=0;
  Real A[2,2]=[3-eps, 1.0; 4.0, 2-eps];
  Real B[2,1]=[1.0; 1.0];
  Real R[1,1]=[1];
  Real G[2,2]=B*<font color="red">transpose</font>(B);
  Real Q[2,2]=[4*eps-11, 2*eps-5; 2*eps-5, 2*eps-2];
  Real Qr1[2,2];
  Real Qr2[2,2];
  Real Qr3[2,2];
  Real deltaQ1;
  Real deltaQ2;
  Real deltaQ3;
  Real H[4,4]=[A,-G; -Q,-<font color="red">transpose</font>(A)];
  Real condH=<font color="red">Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(
                                               H);
  Real normH=<font color="red">Matrices.norm</font>(H, 2);
  Real condX1;
  Real normX1;
  Real condX2;
  Real normX2;
  Real condX3;
  Real normX3;
  Real resX1;
  Real resX2;

<font color="blue">public </font>
  <font color="blue">output </font>Real X1[2,2];
  <font color="blue">output </font>Real X2[2,2];
  <font color="blue">output </font>Real X3[2,2];
  <font color="blue">output </font>Real ku1;
  <font color="blue">output </font>Real ku2;
  <font color="blue">output </font>Real ku3;

<font color="blue">algorithm </font>
   X1:=<font color="red">Matrices.care</font>(A, B, R, Q, false);
   X2:=<font color="red">Matrices.care</font>(A, B, R, Q, true);
   X3:=[2, 1; 1, 1];
<font color="darkgreen">//    ku1:=Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u(A, Q, G, X1);</font>
<font color="darkgreen">//    ku2:=Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u(A, Q, G, X2);</font>
<font color="darkgreen">//    ku3:=Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u(A, Q, G, X3);</font>

  Qr1 := X1*G*X1-<font color="red">transpose</font>(A)*X1-X1*A;
  Qr2 := X2*G*X2-<font color="red">transpose</font>(A)*X2-X2*A;
  Qr3 := X3*G*X3-<font color="red">transpose</font>(A)*X3-X3*A;
  deltaQ1 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr1)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  deltaQ2 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr2)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  deltaQ3 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr3)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  resX1 :=<font color="red"> Modelica.Math.Matrices.norm</font>(X1-X3)/<font color="red">Modelica.Math.Matrices.norm</font>(X3);
  resX2 :=<font color="red"> Modelica.Math.Matrices.norm</font>(X2-X3)/<font color="red">Modelica.Math.Matrices.norm</font>(X3);

  condX1 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X1);
  normX1 :=<font color="red"> Matrices.norm</font>(X1, 2);
  condX2 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X2);
  normX2 :=<font color="red"> Matrices.norm</font>(X2, 2);
  condX3 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X3);
  normX3 :=<font color="red"> Matrices.norm</font>(X3, 2);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Solution X1 without subsequent Newton refinement&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X1, 16, &quot;X1&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Solution X2 with subsequent Newton refinement&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X2, 16, &quot;X2&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Exact solution X3&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X3, 16, &quot;X3&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Residum of solution X1: resX1 = &quot;+<font color="red">String</font>(resX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Residum of solution X2: resX2 = &quot;+<font color="red">String</font>(resX2),outputFile);

  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normH = &quot; +<font color="red"> String</font>(normH),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condH = &quot; +<font color="red"> String</font>(condH),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX1 = &quot; +<font color="red"> String</font>(normX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX1 = &quot; +<font color="red"> String</font>(condX1),outputFile);
<font color="darkgreen">//  Modelica.Utilities.Streams.print(&quot;\n ku1 = &quot; + String(ku1),outputFile);</font>
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX2 = &quot; +<font color="red"> String</font>(normX2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX2 = &quot; +<font color="red"> String</font>(condX2),outputFile);
<font color="darkgreen">//  Modelica.Utilities.Streams.print(&quot;\n ku2 = &quot; + String(ku2),outputFile);</font>
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX3 = &quot; +<font color="red"> String</font>(normX3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX3 = &quot; +<font color="red"> String</font>(condX3),outputFile);
<font color="darkgreen">//  Modelica.Utilities.Streams.print(&quot;\n ku3 = &quot; + String(ku3),outputFile);</font>
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ1 = &quot; +<font color="red"> String</font>(deltaQ1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ2 = &quot; +<font color="red"> String</font>(deltaQ2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ3 = &quot; +<font color="red"> String</font>(deltaQ3),outputFile);
<font color="blue">end </font>care11;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE care12<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Modelica_LinearSystems2.WorkInProgress.Tests.care.care1I.png" ALT="Modelica_LinearSystems2.WorkInProgress.Tests.care.care12" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Modelica_LinearSystems2.WorkInProgress.Tests.care.care12"></A><A HREF="Modelica_LinearSystems2_WorkInProgress_Tests_care.html#Modelica_LinearSystems2.WorkInProgress.Tests.care"
>Modelica_LinearSystems2.WorkInProgress.Tests.care</A>.care12</H2>
<B>Example 12  from Benner benchmarks</B><p>
<P><H3>Information</H3></P>
Extends from <A HREF="file:///C:/Programme/Dymola 7.4 Alpha/Modelica/Library/Modelica 3.1/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A> (Icon for a function).
<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>String</TD><TD>outputFile</TD><TD>&quot;&quot;</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>X1[3, 3]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>X2[3, 3]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>X3[3, 3]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku1</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku2</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku3</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> care12 <font color="darkgreen">&quot;Example 12  from Benner benchmarks&quot;</font>
  <font color="blue">extends </font><A HREF="file:///C:/Programme/Dymola 7.4 Alpha/Modelica/Library/Modelica 3.1/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A>;
  <font color="blue">import </font><A HREF="Modelica_LinearSystems2_Math_Matrices.html#Modelica_LinearSystems2.Math.Matrices"
>Modelica_LinearSystems2.Math.Matrices</A>;
  <font color="blue">input </font>String outputFile = &quot;&quot;;

<font color="blue">protected </font>
  Real eps=1e6;
  Real V[3,3]=[1/3, -2/3, -2/3; -2/3, 1/3, -2/3; -2/3, -2/3, 1/3];
  Real A0[3,3]=eps*[1, 0, 0; 0, 2, 0; 0, 0, 3];
  Real Q0[3,3]=[1/eps, 0, 0; 0, 1, 0; 0, 0, eps];
  Real A[3,3]=V*A0*V;
  Real B[3,3]=<font color="red">identity</font>(3);
  Real R[3,3]=eps*<font color="red">identity</font>(3);
  Real Q[3,3]=V*Q0*V;
<font color="darkgreen">//  Real G[3,3]=B*Modelica.Math.Matrices.solve2(R,B);</font>
  Real G[3,3]=1/eps*<font color="red">identity</font>(3);
  Real x1=eps^2+<font color="red">sqrt</font>(eps^4+1);
  Real x2=2*eps^2+<font color="red">sqrt</font>(4*eps^4+eps);
  Real x3=3*eps^2+<font color="red">sqrt</font>(9*eps^4+eps^2);
  Real D[3,3]=[x1, 0, 0; 0, x2, 0; 0, 0, x3];
  Real Qr1[3,3];
  Real Qr2[3,3];
  Real Qr3[3,3];
  Real deltaQ1;
  Real deltaQ2;
  Real deltaQ3;
  Real H[6,6]=[A,-G; -Q,-<font color="red">transpose</font>(A)];
  Real condH=<font color="red">Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(
                                               H);
  Real normH=<font color="red">Matrices.norm</font>(H, 2);
  Real condX1;
  Real normX1;
  Real condX2;
  Real normX2;
  Real condX3;
  Real normX3;
  Real resX1;
  Real resX2;
<font color="blue">public </font>
  <font color="blue">output </font>Real X1[3,3];
  <font color="blue">output </font>Real X2[3,3];
  <font color="blue">output </font>Real X3[3,3];
  <font color="blue">output </font>Real ku1;
  <font color="blue">output </font>Real ku2;
  <font color="blue">output </font>Real ku3;

<font color="blue">algorithm </font>
  X1:=<font color="red">Matrices.care</font>(A, B, R, Q, false);
  X2:=<font color="red">Matrices.care</font>(A, B, R, Q, true);
  X3:=V*D*V;
  Qr1 := X1*G*X1-<font color="red">transpose</font>(A)*X1-X1*A;
  Qr2 := X2*G*X2-<font color="red">transpose</font>(A)*X2-X2*A;
  Qr3 := X3*G*X3-<font color="red">transpose</font>(A)*X3-X3*A;
  deltaQ1 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr1)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  deltaQ2 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr2)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  deltaQ3 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr3)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  resX1 :=<font color="red"> Modelica.Math.Matrices.norm</font>(X1-X3)/<font color="red">Modelica.Math.Matrices.norm</font>(X3);
  resX2 :=<font color="red"> Modelica.Math.Matrices.norm</font>(X2-X3)/<font color="red">Modelica.Math.Matrices.norm</font>(X3);

 ku1:=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(
    A,
    Q,
    G,
    X1);
 ku2:=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(
    A,
    Q,
    G,
    X2);
 ku3:=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(
    A,
    Q,
    G,
    X3);

  condX1 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X1);
  normX1 :=<font color="red"> Matrices.norm</font>(X1, 2);
  condX2 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X2);
  normX2 :=<font color="red"> Matrices.norm</font>(X2, 2);
  condX3 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X3);
  normX3 :=<font color="red"> Matrices.norm</font>(X3, 2);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Solution X1 without subsequent Newton refinement&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X1, 16, &quot;X1&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Solution X2 with subsequent Newton refinement&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X2, 16, &quot;X2&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Exact solution X3&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X3, 16, &quot;X3&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Residum of solution X1: resX1 = &quot;+<font color="red">String</font>(resX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Residum of solution X2: resX2 = &quot;+<font color="red">String</font>(resX2),outputFile);

  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normH = &quot; +<font color="red"> String</font>(normH),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condH = &quot; +<font color="red"> String</font>(condH),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX1 = &quot; +<font color="red"> String</font>(normX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX1 = &quot; +<font color="red"> String</font>(condX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku1 = &quot; +<font color="red"> String</font>(ku1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX2 = &quot; +<font color="red"> String</font>(normX2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX2 = &quot; +<font color="red"> String</font>(condX2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku2 = &quot; +<font color="red"> String</font>(ku2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX3 = &quot; +<font color="red"> String</font>(normX3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX3 = &quot; +<font color="red"> String</font>(condX3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku3 = &quot; +<font color="red"> String</font>(ku3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ1 = &quot; +<font color="red"> String</font>(deltaQ1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ2 = &quot; +<font color="red"> String</font>(deltaQ2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ3 = &quot; +<font color="red"> String</font>(deltaQ3),outputFile);
<font color="blue">end </font>care12;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE care13<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Modelica_LinearSystems2.WorkInProgress.Tests.care.care1I.png" ALT="Modelica_LinearSystems2.WorkInProgress.Tests.care.care13" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Modelica_LinearSystems2.WorkInProgress.Tests.care.care13"></A><A HREF="Modelica_LinearSystems2_WorkInProgress_Tests_care.html#Modelica_LinearSystems2.WorkInProgress.Tests.care"
>Modelica_LinearSystems2.WorkInProgress.Tests.care</A>.care13</H2>
<B>Example 13  from Benner benchmarks</B><p>
<P><H3>Information</H3></P>
Extends from <A HREF="file:///C:/Programme/Dymola 7.4 Alpha/Modelica/Library/Modelica 3.1/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A> (Icon for a function).
<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>String</TD><TD>outputFile</TD><TD>&quot;&quot;</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>X1[4, 4]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>X2[4, 4]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>X3[4, 4]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku1</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku2</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku3</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> care13 <font color="darkgreen">&quot;Example 13  from Benner benchmarks&quot;</font>
  <font color="blue">extends </font><A HREF="file:///C:/Programme/Dymola 7.4 Alpha/Modelica/Library/Modelica 3.1/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A>;
  <font color="blue">import </font><A HREF="Modelica_LinearSystems2_Math_Matrices.html#Modelica_LinearSystems2.Math.Matrices"
>Modelica_LinearSystems2.Math.Matrices</A>;
  <font color="blue">input </font>String outputFile = &quot;&quot;;

<font color="blue">protected </font>
  Real eps=1e-6;
  Real A[4,4]=[0.0,  0.4,        0.0,       0.0;
               0.0,  0.0,        0.345,     0.0;
               0.0, -0.524/eps, -0.465/eps, 0.262/eps;
               0.0,  0.0,        0.0,      -1/eps];

  Real B[4,1]=[0; 0; 0; 1/eps];
  Real R[1,1]=[1];
  Real G[4,4]=B*<font color="red">transpose</font>(B);
  Real Q[4,4]=[1, 0, 0, 0; 0, 0, 0, 0; 0, 0, 1, 0; 0, 0, 0, 0];
  Real Qr1[4,4];
  Real Qr2[4,4];
  Real Qr3[4,4];
  Real deltaQ1;
  Real deltaQ2;
  Real deltaQ3;
  Real H[8,8]=[A,-G; -Q,-<font color="red">transpose</font>(A)];
  Real condH=<font color="red">Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(
                                               H);
  Real normH=<font color="red">Matrices.norm</font>(H, 2);
  Real condX1;
  Real normX1;
  Real condX2;
  Real normX2;
  Real condX3;
  Real normX3;

<font color="blue">public </font>
  <font color="blue">output </font>Real X1[4,4];
  <font color="blue">output </font>Real X2[4,4];
  <font color="blue">output </font>Real X3[4,4]=[7.3840246663292781e+000,   5.9047620549742454e+000,   3.9930823439894581e-006,   9.9999999994873053e-007;
                       5.9047620549742454e+000,   7.1516063009772344e+000,   3.7996988588428911e-006,   8.6123471821676468e-007;
                       3.9930823439894581e-006,   3.7996988588428911e-006,   1.0402935802354235e-006,   1.8035961902063092e-007;
                       9.9999999994873053e-007,   8.6123471821676468e-007,   1.8035961902063092e-007,   4.6187574179129038e-008];
  <font color="blue">output </font>Real ku1;
  <font color="blue">output </font>Real ku2;
  <font color="blue">output </font>Real ku3=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X3);
<font color="blue">algorithm </font>
  X1:=<font color="red">Matrices.care</font>(A, B, R, Q, false);
  X2:=<font color="red">Matrices.care</font>(A, B, R, Q, true);
  ku1:=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X1);
  ku2:=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X2);
  Qr1 := X1*G*X1-<font color="red">transpose</font>(A)*X1-X1*A;
  Qr2 := X2*G*X2-<font color="red">transpose</font>(A)*X2-X2*A;
  Qr3 := X3*G*X3-<font color="red">transpose</font>(A)*X3-X3*A;
  deltaQ1 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr1)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  deltaQ2 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr2)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  deltaQ3 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr3)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);

  condX1 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X1);
  normX1 :=<font color="red"> Matrices.norm</font>(X1, 2);
  condX2 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X2);
  normX2 :=<font color="red"> Matrices.norm</font>(X2, 2);
  condX3 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X3);
  normX3 :=<font color="red"> Matrices.norm</font>(X3, 2);

  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Solution X1 without subsequent Newton refinement&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X1, 16, &quot;X1&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Solution X2 with subsequent Newton refinement&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X2, 16, &quot;X2&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;MATLAB solution X3&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X3, 16, &quot;X3&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normH = &quot; +<font color="red"> String</font>(normH),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condH = &quot; +<font color="red"> String</font>(condH),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX1 = &quot; +<font color="red"> String</font>(normX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX1 = &quot; +<font color="red"> String</font>(condX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku1 = &quot; +<font color="red"> String</font>(ku1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX2 = &quot; +<font color="red"> String</font>(normX2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX2 = &quot; +<font color="red"> String</font>(condX2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku2 = &quot; +<font color="red"> String</font>(ku2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX3 = &quot; +<font color="red"> String</font>(normX3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX3 = &quot; +<font color="red"> String</font>(condX3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku3 = &quot; +<font color="red"> String</font>(ku3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ1 = &quot; +<font color="red"> String</font>(deltaQ1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ2 = &quot; +<font color="red"> String</font>(deltaQ2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ3 = &quot; +<font color="red"> String</font>(deltaQ3),outputFile);

<font color="blue">end </font>care13;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE care14<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Modelica_LinearSystems2.WorkInProgress.Tests.care.care1I.png" ALT="Modelica_LinearSystems2.WorkInProgress.Tests.care.care14" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Modelica_LinearSystems2.WorkInProgress.Tests.care.care14"></A><A HREF="Modelica_LinearSystems2_WorkInProgress_Tests_care.html#Modelica_LinearSystems2.WorkInProgress.Tests.care"
>Modelica_LinearSystems2.WorkInProgress.Tests.care</A>.care14</H2>
<B>Example 14  from Benner benchmarks</B><p>
<P><H3>Information</H3></P>
Extends from <A HREF="file:///C:/Programme/Dymola 7.4 Alpha/Modelica/Library/Modelica 3.1/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A> (Icon for a function).
<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>String</TD><TD>outputFile</TD><TD>&quot;&quot;</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>X1[4, 4]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>X2[4, 4]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>X3[4, 4]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku1</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku2</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku3</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> care14 <font color="darkgreen">&quot;Example 14  from Benner benchmarks&quot;</font>
<font color="darkgreen">//needs another algorithm; ev of Hamiltonian close to imaginary axis</font>
  <font color="blue">extends </font><A HREF="file:///C:/Programme/Dymola 7.4 Alpha/Modelica/Library/Modelica 3.1/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A>;
  <font color="blue">import </font><A HREF="Modelica_LinearSystems2_Math_Matrices.html#Modelica_LinearSystems2.Math.Matrices"
>Modelica_LinearSystems2.Math.Matrices</A>;
  <font color="blue">input </font>String outputFile = &quot;&quot;;

<font color="blue">protected </font>
  Real eps=1e-6;
  Real A[4,4]=[-eps,  1.0,   0.0,  0.0;
               -1.0,  -eps,  0.0,  0.0;
                0.0,   0.0,  eps,  1.0;
                0.0,  0.0,  -1.0,  eps];

  Real B[4,1]=[1; 1; 1; 1];
  Real G[4,4]=B*<font color="red">transpose</font>(B);
  Real R[1,1]=[1];
  Real C[1,4]=[1, 1, 1, 1];
  Real Q[4,4]=<font color="red">transpose</font>(C)*C;
  Real Qr1[4,4];
  Real Qr2[4,4];
  Real Qr3[4,4];
  Real deltaQ1;
  Real deltaQ2;
  Real deltaQ3;
  Real H[8,8]=[A,-G; -Q,-<font color="red">transpose</font>(A)];
  Real condH=<font color="red">Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(
                                               H);
  Real normH=<font color="red">Matrices.norm</font>(H, 2);
  Real condX1;
  Real normX1;
  Real condX2;
  Real normX2;
  Real condX3;
  Real normX3;

<font color="blue">public </font>
  <font color="blue">output </font>Real X1[4,4];
  <font color="blue">output </font>Real X2[4,4];
  <font color="blue">output </font>Real X3[4,4]=[1.0010401156071251e+000,  -3.0124557362509741e-016,  -1.0421176888569740e-003,   1.0010411167310994e-006;
 -3.0124557362509741e-016,   1.0010421176893556e+000,  -1.0010431186887811e-006,  -1.0421176888547718e-003;
 -1.0421176888569740e-003,  -1.0010431186887811e-006,   1.0010441197755955e+000,  -9.2861916073383455e-017;
  1.0010411167310994e-006,  -1.0421176888547718e-003,  -9.2861916073383455e-017,   1.0010421176893556e+000];
  <font color="blue">output </font>Real ku1;
  <font color="blue">output </font>Real ku2;
  <font color="blue">output </font>Real ku3=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X3);
<font color="blue">algorithm </font>

   X1:=<font color="red">Matrices.care</font>(A, B, R, Q, false);
   X2:=<font color="red">Matrices.care</font>(A, B, R, Q, true);
   ku1:=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X1);
   ku2:=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X2);

  Qr1 := X1*G*X1-<font color="red">transpose</font>(A)*X1-X1*A;
  Qr2 := X2*G*X2-<font color="red">transpose</font>(A)*X2-X2*A;
  Qr3 := X3*G*X3-<font color="red">transpose</font>(A)*X3-X3*A;
  deltaQ1 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr1)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  deltaQ2 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr2)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  deltaQ3 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr3)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);

  condX1 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X1);
  normX1 :=<font color="red"> Matrices.norm</font>(X1, 2);
  condX2 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X2);
  normX2 :=<font color="red"> Matrices.norm</font>(X2, 2);
  condX3 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X3);
  normX3 :=<font color="red"> Matrices.norm</font>(X3, 2);

  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Solution X1 without subsequent Newton refinement&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X1, 16, &quot;X1&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Solution X2 with subsequent Newton refinement&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X2, 16, &quot;X2&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;MATLAB solution X3&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X3, 16, &quot;X3&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normH = &quot; +<font color="red"> String</font>(normH),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condH = &quot; +<font color="red"> String</font>(condH),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX1 = &quot; +<font color="red"> String</font>(normX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX1 = &quot; +<font color="red"> String</font>(condX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku1 = &quot; +<font color="red"> String</font>(ku1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX2 = &quot; +<font color="red"> String</font>(normX2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX2 = &quot; +<font color="red"> String</font>(condX2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku2 = &quot; +<font color="red"> String</font>(ku2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX3 = &quot; +<font color="red"> String</font>(normX3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX3 = &quot; +<font color="red"> String</font>(condX3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku3 = &quot; +<font color="red"> String</font>(ku3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ1 = &quot; +<font color="red"> String</font>(deltaQ1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ2 = &quot; +<font color="red"> String</font>(deltaQ2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ3 = &quot; +<font color="red"> String</font>(deltaQ3),outputFile);

<font color="blue">end </font>care14;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE care15<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Modelica_LinearSystems2.WorkInProgress.Tests.care.care1I.png" ALT="Modelica_LinearSystems2.WorkInProgress.Tests.care.care15" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Modelica_LinearSystems2.WorkInProgress.Tests.care.care15"></A><A HREF="Modelica_LinearSystems2_WorkInProgress_Tests_care.html#Modelica_LinearSystems2.WorkInProgress.Tests.care"
>Modelica_LinearSystems2.WorkInProgress.Tests.care</A>.care15</H2>
<B>Example 15  from Benner benchmarks</B><p>
<P><H3>Information</H3></P>
Extends from <A HREF="file:///C:/Programme/Dymola 7.4 Alpha/Modelica/Library/Modelica 3.1/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A> (Icon for a function).
<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>String</TD><TD>outputFile</TD><TD>&quot;&quot;</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>X1[n, n]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>X2[n, n]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>X3[n, n]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku1</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku2</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>ku3</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> care15 <font color="darkgreen">&quot;Example 15  from Benner benchmarks&quot;</font>
  <font color="blue">extends </font><A HREF="file:///C:/Programme/Dymola 7.4 Alpha/Modelica/Library/Modelica 3.1/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A>;
  <font color="blue">import </font><A HREF="Modelica_LinearSystems2_Math_Matrices.html#Modelica_LinearSystems2.Math.Matrices"
>Modelica_LinearSystems2.Math.Matrices</A>;
  <font color="blue">input </font>String outputFile = &quot;&quot;;

<font color="blue">protected </font>
  Integer N=10;
  Integer n=2*N - 1;
  Real A[n,n];
  Real A11[2,2]=[-1,0; 1,0];
  Real A12[2,2]=[0,0; -1,0];
  Real B[n,N]=<font color="red">zeros</font>(n, N);
  Real R[N,N]=<font color="red">identity</font>(N);
  Real C[N - 1,n]=<font color="red">zeros</font>(N - 1, n);

<font color="darkgreen">//  Real Qtilde[N - 1,N - 1]=10*identity(N - 1);</font>
  Real Q[n,n];
  Real G[n,n];
  Real Qr1[n,n];
  Real Qr2[n,n];
  Real Qr3[n,n];
  Real deltaQ1;
  Real deltaQ2;
  Real deltaQ3;
  Real H[2*n,2*n];
  Real condH;
  Real normH;
  Real condX1;
  Real normX1;
  Real condX2;
  Real normX2;
  Real condX3;
  Real normX3;

<font color="blue">public </font>
  <font color="blue">output </font>Real X1[n,n];
  <font color="blue">output </font>Real X2[n,n];
  <font color="blue">output </font>Real X3[n,n];
  <font color="blue">output </font>Real ku1;
  <font color="blue">output </font>Real ku2;
  <font color="blue">output </font>Real ku3;
<font color="blue">algorithm </font>

  <font color="blue">for </font>i<font color="blue"> in </font>1:N - 2<font color="blue"> loop</font>
    A[2*i - 1:2*i, 2*i - 1:2*i] := A11;
    A[2*i - 1:2*i, 2*i + 1:2*i + 2] := A12;
  <font color="blue">end for</font>;
  A[2*N - 3:2*N - 2, 2*N - 3:2*N - 2] := A11;
  A[2*N - 3:2*N - 2, n] := {0,-1};
  A[n, n] := -1;
  <font color="blue">for </font>i<font color="blue"> in </font>1:N<font color="blue"> loop</font>
    B[2*i - 1, i] := 1;
  <font color="blue">end for</font>;

  <font color="blue">for </font>i<font color="blue"> in </font>1:N - 1<font color="blue"> loop</font>
    C[i, 2*i] := 1;
  <font color="blue">end for</font>;

  Q := 10*<font color="red">transpose</font>(C)*C;
  G := B*<font color="red">transpose</font>(B);
  H := [A,-G; -Q,-<font color="red">transpose</font>(A)];
  condH :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(H);
  normH :=<font color="red"> Matrices.norm</font>(H, 2);
  X1 :=<font color="red"> Matrices.care</font>(A, B, R, Q, false);
  X2 :=<font color="red"> Matrices.care</font>(A, B, R, Q, true);
  X3 := [1.4082559065178322e+000,     2.6676190896796159e+000,    -6.5821877192134037e-001,     1.0403124013014682e+000,    -2.4213305071508348e-001,     6.3973908750417130e-001,    -1.3823693339063511e-001,     4.4314597806254619e-001,    -9.4550040089693782e-002,     3.2016958489789538e-001,    -7.2001791061836087e-002,     2.3193432570454367e-001,    -5.9138156142420961e-002,     1.6238522686498319e-001,    -5.1533381176332015e-002,     1.0345269956755773e-001,    -4.7208569311630019e-002,     5.0403617291428171e-002,    -4.5235212708863534e-002;
  2.6676190896796159e+000,     7.6495166131912269e+000,    -1.6273066883781477e+000,     1.5927818788684047e+000,    -4.0057331379729999e-001,     8.5152714962393961e-001,    -1.9659310944162395e-001,     5.5113731416796208e-001,    -1.2297639316465336e-001,     3.8276339101187096e-001,    -8.8235259193352511e-002,     2.7048358127353234e-001,    -6.9549098839561146e-002,     1.8637984242782363e-001,    -5.8932527297422418e-002,     1.1756218375544031e-001,    -5.3049082276130421e-002,     5.6964417726470790e-002,    -5.0403617291430391e-002;
 -6.5821877192134037e-001,    -1.6273066883781477e+000,     1.8243416277240885e+000,     2.2670457758823135e+000,    -5.5432265459688956e-001,     8.4371929185984573e-001,    -1.9844615741414437e-001,     5.1676269433951449e-001,    -1.1568868436277591e-001,     3.5491071886919373e-001,    -8.1686405170275478e-002,     2.5062048605833698e-001,    -6.4397016095746384e-002,     1.7300179840712135e-001,    -5.4813344277716447e-002,     1.0933614458885377e-001,    -4.9560024573569200e-002,     5.3049082276127958e-002,    -4.7208569311627174e-002;
  1.0403124013014682e+000,     1.5927818788684047e+000,     2.2670457758823135e+000,     8.5010437628151578e+000,    -1.8238997978197693e+000,     2.1439191930363632e+000,    -5.2354970696195324e-001,     1.2342905406358069e+000,    -2.8482836863497241e-001,     8.2162089544150141e-001,    -1.9252549200421060e-001,     5.6914323343969642e-001,    -1.4716778649077566e-001,     3.8804576502897303e-001,    -1.2259818111568910e-001,     2.4334426015429533e-001,    -1.0933614458885396e-001,     1.1756218375543964e-001,    -1.0345269956755715e-001;
 -2.4213305071508348e-001,    -4.0057331379729999e-001,    -5.5432265459688956e-001,    -1.8238997978197693e+000,     1.8680285210250251e+000,     2.1440693827176647e+000,    -5.3177440556903477e-001,     7.5548403266649311e-001,    -1.8558252249472512e-001,     4.4721359549995687e-001,    -1.0808390939668928e-001,     2.9597819157177063e-001,    -7.7361593305573073e-002,     1.9757140378220453e-001,    -6.2423659492983979e-002,     1.2259818111569062e-001,    -5.4813344277716183e-002,     5.8932527297423709e-002,    -5.1533381176330897e-002;
  6.3973908750417130e-001,     8.5152714962393961e-001,     8.4371929185984573e-001,     2.1439191930363632e+000,     2.1440693827176647e+000,     8.8838071538270462e+000,    -1.9121350570131288e+000,     2.4144027743098979e+000,    -5.9309880580151031e-001,     1.4206703830636349e+000,    -3.4376089593239723e-001,     9.3918307919693822e-001,    -2.4557457428033913e-001,     6.2610765116617340e-001,    -1.9757140378220456e-001,     3.8804576502897542e-001,    -1.7300179840712107e-001,     1.8637984242782429e-001,    -1.6238522686498102e-001;
 -1.3823693339063511e-001,    -1.9659310944162395e-001,    -1.9844615741414437e-001,    -5.2354970696195324e-001,    -5.3177440556903477e-001,    -1.9121350570131288e+000,     1.8808921559444487e+000,     2.0745202838781052e+000,    -5.2416963060294719e-001,     6.9655150536906829e-001,    -1.8125771063002102e-001,     3.9416451322382728e-001,    -1.0611055279392437e-001,     2.4557457428034329e-001,    -7.7361593305573809e-002,     1.4716778649077725e-001,    -6.4397016095748355e-002,     6.9549098839562368e-002,    -5.9138156142419532e-002;
  4.4314597806254619e-001,     5.5113731416796208e-001,     5.1676269433951449e-001,     1.2342905406358069e+000,     7.5548403266649311e-001,     2.4144027743098979e+000,     2.0745202838781052e+000,     9.0701869962548631e+000,    -1.9710675843105483e+000,     2.5319649580653412e+000,    -6.4614788807763779e-001,     1.4776348007901072e+000,    -3.9416451322382506e-001,     9.3918307919694666e-001,    -2.9597819157177285e-001,     5.6914323343969908e-001,    -2.5062048605833365e-001,     2.7048358127354011e-001,    -2.3193432570454176e-001;
 -9.4550040089693782e-002,    -1.2297639316465336e-001,    -1.1568868436277591e-001,    -2.8482836863497241e-001,    -1.8558252249472512e-001,    -5.9309880580151031e-001,    -5.2416963060294719e-001,    -1.9710675843105483e+000,     1.8852169678091515e+000,     2.0214712016019787e+000,    -5.2219627400018265e-001,     6.4614788807764112e-001,    -1.8125771063002138e-001,     3.4376089593239728e-001,    -1.0808390939668934e-001,     1.9252549200421426e-001,    -8.1686405170278073e-002,     8.8235259193352858e-002,    -7.2001791061837433e-002;
  3.2016958489789538e-001,     3.8276339101187096e-001,     3.5491071886919373e-001,     8.2162089544150141e-001,     4.4721359549995687e-001,     1.4206703830636349e+000,     6.9655150536906829e-001,     2.5319649580653412e+000,     2.0214712016019787e+000,     9.1271514139813448e+000,    -2.0214712016019751e+000,     2.5319649580653465e+000,    -6.9655150536906496e-001,     1.4206703830636469e+000,    -4.4721359549996020e-001,     8.2162089544150407e-001,    -3.5491071886919606e-001,     3.8276339101187495e-001,    -3.2016958489789654e-001;
 -7.2001791061836087e-002,    -8.8235259193352511e-002,    -8.1686405170275478e-002,    -1.9252549200421060e-001,    -1.0808390939668928e-001,    -3.4376089593239723e-001,    -1.8125771063002102e-001,    -6.4614788807763779e-001,    -5.2219627400018265e-001,    -2.0214712016019751e+000,     1.8852169678091517e+000,     1.9710675843105498e+000,    -5.2416963060294630e-001,     5.9309880580151564e-001,    -1.8558252249472756e-001,     2.8482836863497613e-001,    -1.1568868436277815e-001,     1.2297639316465223e-001,    -9.4550040089693546e-002;
  2.3193432570454367e-001,     2.7048358127353234e-001,     2.5062048605833698e-001,     5.6914323343969642e-001,     2.9597819157177063e-001,     9.3918307919693822e-001,     3.9416451322382728e-001,     1.4776348007901072e+000,     6.4614788807764112e-001,     2.5319649580653465e+000,     1.9710675843105498e+000,     9.0701869962548720e+000,    -2.0745202838781021e+000,     2.4144027743099121e+000,    -7.5548403266649689e-001,     1.2342905406358144e+000,    -5.1676269433951971e-001,     5.5113731416796430e-001,    -4.4314597806254674e-001;
 -5.9138156142420961e-002,    -6.9549098839561146e-002,    -6.4397016095746384e-002,    -1.4716778649077566e-001,    -7.7361593305573073e-002,    -2.4557457428033913e-001,    -1.0611055279392437e-001,    -3.9416451322382506e-001,    -1.8125771063002138e-001,    -6.9655150536906496e-001,    -5.2416963060294630e-001,    -2.0745202838781021e+000,     1.8808921559444463e+000,     1.9121350570131264e+000,    -5.3177440556903433e-001,     5.2354970696195180e-001,    -1.9844615741414337e-001,     1.9659310944162223e-001,    -1.3823693339063431e-001;
  1.6238522686498319e-001,     1.8637984242782363e-001,     1.7300179840712135e-001,     3.8804576502897303e-001,     1.9757140378220453e-001,     6.2610765116617340e-001,     2.4557457428034329e-001,     9.3918307919694666e-001,     3.4376089593239728e-001,     1.4206703830636469e+000,     5.9309880580151564e-001,     2.4144027743099121e+000,     1.9121350570131264e+000,     8.8838071538270533e+000,    -2.1440693827176691e+000,     2.1439191930363739e+000,    -8.4371929185984795e-001,     8.5152714962394327e-001,    -6.3973908750416852e-001;
 -5.1533381176332015e-002,    -5.8932527297422418e-002,    -5.4813344277716447e-002,    -1.2259818111568910e-001,    -6.2423659492983979e-002,    -1.9757140378220456e-001,    -7.7361593305573809e-002,    -2.9597819157177285e-001,    -1.0808390939668934e-001,    -4.4721359549996020e-001,    -1.8558252249472756e-001,    -7.5548403266649689e-001,    -5.3177440556903433e-001,    -2.1440693827176691e+000,     1.8680285210250318e+000,     1.8238997978197702e+000,    -5.5432265459689178e-001,     4.0057331379729610e-001,    -2.4213305071508179e-001;
  1.0345269956755773e-001,     1.1756218375544031e-001,     1.0933614458885377e-001,     2.4334426015429533e-001,     1.2259818111569062e-001,     3.8804576502897542e-001,     1.4716778649077725e-001,     5.6914323343969908e-001,     1.9252549200421426e-001,     8.2162089544150407e-001,     2.8482836863497613e-001,     1.2342905406358144e+000,     5.2354970696195180e-001,     2.1439191930363739e+000,     1.8238997978197702e+000,     8.5010437628151774e+000,    -2.2670457758823197e+000,     1.5927818788684029e+000,    -1.0403124013014655e+000;
 -4.7208569311630019e-002,    -5.3049082276130421e-002,    -4.9560024573569200e-002,    -1.0933614458885396e-001,    -5.4813344277716183e-002,    -1.7300179840712107e-001,    -6.4397016095748355e-002,    -2.5062048605833365e-001,    -8.1686405170278073e-002,    -3.5491071886919606e-001,    -1.1568868436277815e-001,    -5.1676269433951971e-001,    -1.9844615741414337e-001,    -8.4371929185984795e-001,    -5.5432265459689178e-001,    -2.2670457758823197e+000,     1.8243416277240905e+000,     1.6273066883781486e+000,    -6.5821877192133904e-001;
  5.0403617291428171e-002,     5.6964417726470790e-002,     5.3049082276127958e-002,     1.1756218375543964e-001,     5.8932527297423709e-002,     1.8637984242782429e-001,     6.9549098839562368e-002,     2.7048358127354011e-001,     8.8235259193352858e-002,     3.8276339101187495e-001,     1.2297639316465223e-001,     5.5113731416796430e-001,     1.9659310944162223e-001,     8.5152714962394327e-001,     4.0057331379729610e-001,     1.5927818788684029e+000,     1.6273066883781486e+000,     7.6495166131912367e+000,    -2.6676190896796150e+000;
 -4.5235212708863534e-002,    -5.0403617291430391e-002,    -4.7208569311627174e-002,    -1.0345269956755715e-001,    -5.1533381176330897e-002,    -1.6238522686498102e-001,    -5.9138156142419532e-002,    -2.3193432570454176e-001,    -7.2001791061837433e-002,    -3.2016958489789654e-001,    -9.4550040089693546e-002,    -4.4314597806254674e-001,    -1.3823693339063431e-001,    -6.3973908750416852e-001,    -2.4213305071508179e-001,    -1.0403124013014655e+000,    -6.5821877192133904e-001,    -2.6676190896796150e+000,     1.4082559065178297e+000];

  ku1:=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X1);
  ku2:=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X2);
  ku3:=<font color="red">Modelica_LinearSystems2.Math.Matrices.Internal.k_care_u</font>(A, Q, G, X3);
  Qr1 := X1*G*X1-<font color="red">transpose</font>(A)*X1-X1*A;
  Qr2 := X2*G*X2-<font color="red">transpose</font>(A)*X2-X2*A;
  Qr3 := X3*G*X3-<font color="red">transpose</font>(A)*X3-X3*A;
  deltaQ1 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr1)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  deltaQ2 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr2)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);
  deltaQ3 :=<font color="red"> Modelica.Math.Matrices.norm</font>(Q-Qr3)/<font color="red">Modelica.Math.Matrices.norm</font>(Q);

  condX1 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X1);
  normX1 :=<font color="red"> Matrices.norm</font>(X1, 2);
  condX2 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X2);
  normX2 :=<font color="red"> Matrices.norm</font>(X2, 2);
  condX3 :=<font color="red"> Modelica_LinearSystems2.Math.Matrices.conditionNumber</font>(X3);
  normX3 :=<font color="red"> Matrices.norm</font>(X3, 2);

  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Solution X1 without subsequent Newton refinement&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X1, 16, &quot;X1&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Solution X2 with subsequent Newton refinement&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X2, 16, &quot;X2&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;MATLAB solution X3&quot;,outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(<font color="red">Matrices.printMatrix</font>(X3, 16, &quot;X3&quot;),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normH = &quot; +<font color="red"> String</font>(normH),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condH = &quot; +<font color="red"> String</font>(condH),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX1 = &quot; +<font color="red"> String</font>(normX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX1 = &quot; +<font color="red"> String</font>(condX1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku1 = &quot; +<font color="red"> String</font>(ku1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX2 = &quot; +<font color="red"> String</font>(normX2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX2 = &quot; +<font color="red"> String</font>(condX2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku2 = &quot; +<font color="red"> String</font>(ku2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n normX3 = &quot; +<font color="red"> String</font>(normX3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n condX3 = &quot; +<font color="red"> String</font>(condX3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n ku3 = &quot; +<font color="red"> String</font>(ku3),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ1 = &quot; +<font color="red"> String</font>(deltaQ1),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ2 = &quot; +<font color="red"> String</font>(deltaQ2),outputFile);
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;\n deltaQ3 = &quot; +<font color="red"> String</font>(deltaQ3),outputFile);

<font color="blue">end </font>care15;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE runAll<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Modelica_LinearSystems2.WorkInProgress.Tests.care.care1I.png" ALT="Modelica_LinearSystems2.WorkInProgress.Tests.care.runAll" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Modelica_LinearSystems2.WorkInProgress.Tests.care.runAll"></A><A HREF="Modelica_LinearSystems2_WorkInProgress_Tests_care.html#Modelica_LinearSystems2.WorkInProgress.Tests.care"
>Modelica_LinearSystems2.WorkInProgress.Tests.care</A>.runAll</H2>
<B>Executes all functions with name care*.mo in this directory/package</B><p>
<P><H3>Information</H3></P>
Extends from <A HREF="file:///C:/Programme/Dymola 7.4 Alpha/Modelica/Library/Modelica 3.1/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A> (Icon for a function).
<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>String</TD><TD>specifier</TD><TD>&quot;care&quot;</TD><TD>&nbsp;</TD></TR>
<TR><TD>String</TD><TD>outputFile</TD><TD>specifier + &quot;.txt&quot;</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>Integer</TD><TD>numberOfFunctions</TD><TD>&nbsp;</TD></TR>
<TR><TD>Boolean</TD><TD>ok</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> runAll <font color="darkgreen">
  &quot;Executes all functions with name care*.mo in this directory/package&quot;</font>
  <font color="blue">extends </font><A HREF="file:///C:/Programme/Dymola 7.4 Alpha/Modelica/Library/Modelica 3.1/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A>;
  <font color="blue">import </font><A HREF="Modelica_LinearSystems2_WorkInProgress_Tests.html#Modelica_LinearSystems2.WorkInProgress.Tests"
>Modelica_LinearSystems2.WorkInProgress.Tests</A>;

  <font color="blue">input </font>String specifier = &quot;care&quot;;
  <font color="blue">input </font>String outputFile = specifier +&quot;.txt&quot;;
  <font color="blue">output </font>Integer numberOfFunctions;
  <font color="blue">output </font>Boolean ok;

<font color="blue">protected </font>
  String careMos = specifier + &quot;.mos&quot;;
  String functions[:];
  String functions2[:];
  String h=&quot;care.&quot;;
  Integer index;
  Integer n;
  Integer i;

<font color="blue">algorithm </font>
  <font color="blue">if </font><font color="red">Modelica.Utilities.Files.exist</font>(careMos)<font color="blue"> then</font>
    <font color="red">Modelica.Utilities.Files.removeFile</font>(careMos);
  <font color="blue">end if</font>;
  <font color="blue">if </font><font color="red">Modelica.Utilities.Files.exist</font>(outputFile)<font color="blue"> then</font>
    <font color="red">Modelica.Utilities.Files.removeFile</font>(outputFile);
  <font color="blue">end if</font>;
  <font color="red">Modelica.Utilities.Streams.print</font>(&quot;import Modelica_LinearSystems2.Tests.care&quot;,careMos);

  (functions, n) :=<font color="red"> Tests.Internal.getMoFiles</font>(specifier);
  functions2 :=<font color="red"> fill</font>(&quot;&quot;,n);
  <font color="blue">for </font>i<font color="blue"> in </font>1:n<font color="blue"> loop</font>
    index :=<font color="red"> Modelica.Utilities.Strings.find</font>(functions[i],&quot;.&quot;);
    functions2[i] :=<font color="red"> Modelica.Utilities.Strings.substring</font>(functions[i],1,index-1);
    <font color="red">Modelica.Utilities.Streams.print</font>(&quot;Modelica.Utilities.Streams.print(\&quot;\\n\\n### &quot;+functions2[i]+&quot; ###\\n\&quot;,\&quot;&quot; + outputFile+ &quot;\&quot;)&quot;,careMos);
    functions2[i] := h+functions2[i] +&quot;(\&quot;&quot;+outputFile+&quot;\&quot; )&quot;;
    <font color="red">Modelica.Utilities.Streams.print</font>(functions2[i],careMos);
  <font color="blue">end for</font>;
    ok :=<font color="red"> RunScript</font>(careMos);

numberOfFunctions := n;
<font color="blue">end </font>runAll;
</PRE>
<HR>
<address>HTML-documentation generated by <a href="http://www.Dymola.com/">Dymola</a> Fri Jan 15 12:29:05 2010.
</address></BODY>
</HTML>
